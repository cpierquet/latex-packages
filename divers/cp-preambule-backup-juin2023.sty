\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{cp-preambule}[2023/06/15 Préambule de base, v0.2.b]
% 0.2.b	suppression de la création du répertoire build
% 0.2.a	modification des boîtes de cours
% 0.1.h	evironnement python "à la manière de thonny"
% 0.1.g	environnement pyluatex et repl
% 0.1.f	[lua] pour tkz-euclide si besoin + newpapierseyes
% 0.1.e	hvlogos -> hologo pour compatibilité
% 0.1.d	Essai de modif ; en opérateur modemath
% 0.1.c	Karnaugh + modif siunitx
% 0.1.b	Fusion des cp-* + Karnaugh
% 0.1.a	Version initiale, avec gros nettoyage !!!!!!

% ======================================base
\RequirePackage{iftex,ifluatex,ifxetex,ifpdf,ifthen}

% ============les entetes [noentete/exambts]
\newif\if@entete \@entetetrue
\newif\if@noentete \@noentetefalse
\newif\if@exambts \@exambtsfalse
\DeclareOption{noentete}{\@entetefalse \@noentetetrue}
\DeclareOption{exambts}{\@entetefalse \@exambtstrue}
% ===================stylev2 pour les boîtes
\newif\if@newstyle \@newstyletrue
\DeclareOption{AncienStyle}{\@newstylefalse}
% ======commandes exos [sujet/sujetl/revgoku]
\newif\if@sujet \@sujetfalse
\DeclareOption{sujet}{\@sujettrue}
\newif\if@sujetl \@sujetlfalse
\DeclareOption{sujetl}{\@sujetltrue}
\newif\if@revgoku \@revgokufalse
\DeclareOption{revgoku}{\@revgokutrue}
% =======================option polices [alt]
\newif\if@alt \@altfalse
\DeclareOption{alt}{\@alttrue}
% ===============boîtes breakable [breakable]
\newif\if@breakable \@breakablefalse
\DeclareOption{breakable}{\@breakabletrue}
% ============================fin des options
\DeclareOption*{}%si option inconnue ;-)
\ProcessOptions\relax

% ===============================Qques modifs
%\everymath{\displaystyle}
\RequirePackage[table,svgnames]{xcolor}
\AtBeginDocument{%
	\abovedisplayskip=0.33\baselineskip
	\abovedisplayshortskip=0.33\baselineskip
	\belowdisplayskip=0.33\baselineskip
	\belowdisplayshortskip=0.33\baselineskip
	%\ifnum\ShellEscapeStatus=1 \ShellEscape{mkdir build} \fi
}

% =================================lua ou pdf
\ifluatex %si moteur=lualatex
	\RequirePackage{realscripts}
	\defaultfontfeatures{Ligatures={TeX}}
\else %sinon pdflatex ou latex
	\newcommand\hmmax{0} % patch pour les alphabets multiples ?
	\newcommand\bmmax{0}
	\RequirePackage[upright]{fourier}
	\RequirePackage{mathtools}
	\RequirePackage{amsmath,amssymb,amstext}
	\RequirePackage[scaled=0.875]{helvet}
	\renewcommand\ttdefault{lmtt}
	\RequirePackage[scaled=1]{cabin} % sf
\fi

%=====================================polices
\DeclareSymbolFont{calletters}{OMS}{cmsy}{m}{n}
\DeclareSymbolFontAlphabet{\mathcallig}{calletters}
\RequirePackage[mathscr]{eucal}
\ifluatex %on réduit le nb de polices quand même !
	\if@alt
		\newfontfamily\inconso{Inconsolatazi4}
		\newfontfamily\algol{AlgolRevived}
		\newcommand\sffalt{\inconso}
		\newcommand\ttfalt{\algol}
		\newfontfamily\policeqtcanaithtype{QTCanaithtype}
	\fi
	\newfontfamily\fontnwks{SourceCodePro-Medium} %numworks
	\newfontfamily\policetititreboite{Mint Spirit}
	\newfontfamily\fontcalcqd{GoMono-Bold} %casio90
	\newfontfamily\fontcalctc{AnonymousPro} %casio35
	\newfontfamily\fontcasiotc{AnonymousPro} %casio35
	\newfontfamily\fontcasioqd{AlegreyaSans} %casio90
	\newfontfamily\poltuto{QTSanDiego}
	\newcommand\fontbox{\policetititreboite}
	\newcommand\titrebox[1]{\textbf{\scalebox{0.925}[1]{#1}}}
	\newcommand\policecasiotc{\fontcasiotc\bfseries\footnotesize}
	\newcommand\policecasioqd{\fontcasioqd\bfseries\footnotesize}
	\newcommand\tuto[1]{{\poltuto #1}}
\else
	\if@alt
		\newcommand\sffalt{\sffamily}
		\newcommand\ttfalt{\ttfamily}
	\fi
	\newcommand\fontbox{\sffamily}
	\newcommand\titrebox[1]{\textbf{#1}}
	\newcommand\policecasiotc{\ttfamily\bfseries\small}
	\newcommand\policecasioqd{\ttfamily\bfseries\small}
	\newcommand\tuto[1]{{\textsf #1}}
	\newcommand\fontnwks{\ttfamily}
\fi

%============================packages de base
\RequirePackage[only,llbracket,rrbracket]{stmaryrd}
\RequirePackage{shellesc}
\ifthenelse{\isundefined{\euro}}{\newcommand\euro{\eurologo{}}}{\renewcommand\euro{\eurologo{}}}
\RequirePackage{hologo}
\RequirePackage{esvect}
\RequirePackage{nicematrix}
\usepackage[most]{tcolorbox}
\RequirePackage{colortbl}
\RequirePackage{tabularx}
\RequirePackage{multirow}
\RequirePackage{simplekv}
\RequirePackage{listofitems}
\RequirePackage{xstring}
\RequirePackage{xintexpr}
\RequirePackage{xintbinhex}
\RequirePackage{listofitems}
\RequirePackage{tabularray}
\RequirePackage{multicol}
\RequirePackage[normalem]{ulem}
\RequirePackage{pifont}
\RequirePackage{enumitem}
\RequirePackage{cancel}
\RequirePackage{wrapstuff}
\RequirePackage{siunitx} %test avec v3
\sisetup{%
	locale=FR,mode=match, propagate-math-font=true,%
	reset-math-version=false,reset-text-family=false,%
	reset-text-series=false,reset-text-shape=false,%
	text-family-to-math=true,text-series-to-math=true,%
	output-decimal-marker={,},%
	group-minimum-digits=4%
}
\RequirePackage{tkz-base}
\RequirePackage{tkz-fct}
\ifluatex %si moteur=lualatex
	\RequirePackage[lua]{tkz-euclide}
\else
	\RequirePackage{tkz-euclide}
\fi
\RequirePackage{tkz-tab}
\usetikzlibrary{automata,positioning}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{patterns,patterns.meta}
\usetikzlibrary{calc}
\RequirePackage{wrapstuff}
\RequirePackage{fancyhdr}
\RequirePackage{nicefrac}
\RequirePackage{fancyqr}
\RequirePackage{wasysym}
\RequirePackage{xargs}
\RequirePackage{graphicx}
\RequirePackage{systeme}
\RequirePackage{venndiagram}
\RequirePackage{pas-tableur}
\RequirePackage{fancyvrb}
\RequirePackage{lastpage}
\RequirePackage{currfile}
\RequirePackage{tabto}
\RequirePackage{tangente}
%\RequirePackage{bigstrut}
%\RequirePackage{pstricks}
\RequirePackage{interval}
\RequirePackage{textualicomma}
\RequirePackage{lettrine}
\RequirePackage{ccicons}
\RequirePackage{amsopn}
\DeclareMathSymbol{;}\mathbin{operators}{'73} % \mathpunct à l'origine
\DeclareMathSymbol{]}\mathord{operators}{093} % \mathclose à l'origine
\DeclareMathSymbol{[}\mathord{operators}{091} % \mathopen à l'origine

\newcommand\logolycee{$\vcenter{\hbox{\includegraphics[height=0.9\baselineskip]{logo_lycee}}}$}
\newcommand\logopython{$\vcenter{\hbox{\includegraphics[height=0.9\baselineskip]{logopython}}}$}

\ifpdf
	\RequirePackage{hyperref}
\else
	\RequirePackage[dvips]{hyperref}
\fi

% ===============env. python (à la manière de Thonny)
\ifluatex
	\tcbuselibrary{listings}
	\lstdefinestyle{pythonthonny}{%
		language          = python,
		inputencoding     = utf8,
		basicstyle        = \ttfamily\footnotesize,
		keywordstyle      = \color{ForestGreen},
		keywordstyle      = [2]\color{purple},
		commentstyle      = \color{gray}\itshape,
		stringstyle       = \color{red!75},
		numberstyle       = \tiny\sffamily\color{DarkGray!25!Black},
		aboveskip        =  0pt,
		belowskip         = 0pt,
		tabsize           = 4,
		showstringspaces  = false,
		columns           = fullflexible,
		keepspaces        = true,
		breaklines        = true,
		breakatwhitespace = true
	}
\else
	\tcbuselibrary{listingsutf8}
	\lstdefinestyle{pythonthonny}{%
		language          = python,
		inputencoding     = utf8/latin1,
		basicstyle        = \ttfamily\footnotesize,
		keywordstyle      = \color{ForestGreen},
		keywordstyle      = [2]\color{purple},
		commentstyle      = \color{gray}\itshape,
		stringstyle       = \color{red!75},
		numberstyle       = \tiny\ttfamily\color{DarkGray!25!Black},
		aboveskip        =  0pt,
		belowskip         = 0pt,
		tabsize           = 4,
		showstringspaces  = false,
		columns           = fullflexible,
		keepspaces        = true,
		breaklines        = true,
		breakatwhitespace = true
	}
\fi

\tcbset{thonnycpstyle/.style={%
	boxrule=0.75pt,colframe=DarkGray!25!Black,%
	enhanced,sharp corners,%
	top=0mm,bottom=0mm,%
	before skip=\baselineskip,after skip=\baselineskip,%
	colback=white,%
	listing only,listing engine=listings,%
	}
}

\tcbset{thonnystylecpnolineos/.style={%
	thonnycpstyle,
	leftupper=2mm,rightupper=5mm,
	listing options={style=pythonthonny,xleftmargin=1.5mm,numbers=none}
	}
}

\tcbset{thonnystylecplineos/.style={%
	thonnycpstyle,%
	leftupper=6mm,rightupper=5mm,
	listing options={style=pythonthonny,xleftmargin=6.5mm,numbers=left},%
	underlay={%
		\begin{tcbclipinterior}
			\filldraw[lightgray] (interior.south west) rectangle ([xshift=5mm]interior.north west) ;
		\end{tcbclipinterior}%
		}
	}
}

\tcbset{nocadre/.style={frame hidden}}

\NewTCBListing{CodePythonThonny}{ s m }{%
	\IfBooleanTF{#1}{thonnystylecpnolineos}{thonnystylecplineos},%
	hbox,#2
}

% ===============env. python (sans proflycee)
\newenvironment{envconsolepython}[1][\linewidth]{%
	\VerbatimEnvironment
	\begin{center}
	\begin{minipage}{#1}
	\begin{pyconsole}[][framesep=3mm,frame=single,label={[\scriptsize Début de la console \logopython]\scriptsize Fin de la console \logopython},fontsize=\footnotesize,framerule=1pt,rulecolor=\color{ForestGreen}]
	}
	{
	\end{pyconsole}
	\end{minipage}
	\end{center}
}

% ===============env console pyluatex
\ifluatex
	%\RequirePackage[executable=python]{pyluatex}
	%il faut charger manuellement pyluatex pour l'exécutable
	\NewDocumentEnvironment{EnvConsolePiton}{ s O{} m }%1=options piton,2=options tcbox
	{%
		\PyLTVerbatimEnv
		\PitonOptions{background-color=white,prompt-background-color=white,#2}
		\begin{tcolorbox}[enhanced,boxrule=1pt,sharp corners=all,before skip=12pt,after skip=12pt,left=1pt,right=1pt,%
			top=1pt,bottom=1pt,rightupper=1pt,leftupper=1pt,colframe=ForestGreen,colback=white,fontupper=\footnotesize,fontlower=\footnotesize,%
			overlay={%
				\draw[Gray] (frame.north) node[ForestGreen,font=\scriptsize\ttfamily,fill=white] {Début de la console \IfBooleanTF{#1}{\logopython}{Python}} ;
				\draw[Gray] (frame.south) node[ForestGreen,font=\scriptsize\ttfamily,fill=white] {Fin de la console \IfBooleanTF{#1}{\logopython}{Python}} ;
			},#3]
		\begin{pythonrepl}
	}%
	{%
		\directlua
		{
			tex.print("\\begin{Piton}")
			tex.print(pyluatex.get_last_output())
			tex.print("\\end{Piton}")
			tex.print("")
		}
		\end{pythonrepl}
		\end{tcolorbox}
	}
\fi

% ==================================altcenter
\newenvironment{altcenter}[1][\topsep]% 
	{\setlength{\topsep}{#1}\par\kern\topsep\centering} %\begin{mycenter}[<len>]
	{\par\kern\topsep}% \end{mycenter}
	
% ===========================mirror et images
\newcommand\mirroir[1]{%
	\raisebox{\depth}{\scalebox{-1}[-1]{\footnotesize\textcolor{ForestGreen}{#1}}}
}
\newcommand\minicalc[2][0.8em]{%
	\raisebox{-0.05em}{\includegraphics[height=#1]{#2}}
}

% ======================================Maths
\renewcommand\i{\rm{i}} %pour hyperref !
\newcommand\ssi{\Leftrightarrow}
\newcommand\pp{\leqslant}
\newcommand\pg{\geqslant}
\newcommand\courbe[1]{\mathscr{C}_{#1}}
\newcommand\loinorm[3]{#1 \hookrightarrow \mathcallig{N} \left(#2;#3\right)}
\newcommand\binomiale[2]{\mathcallig{B} \left(#1;#2\right)}
\newcommand\loibinom[3]{#1 \hookrightarrow \mathcallig{B} \left(#2;#3\right)}
\newcommand\normale[2]{\mathcallig{N} \left(#1;#2\right)}
\newcommand\suiten[1][u]{\left( #1_n \right)}
\newcommand\suiteun{\left( u_n \right)}
\newcommand\suitevn{\left( v_n \right)}
\newcommand\matdeux[4]{\begin{pmatrix} #1 & #2 \\ #3 & #4 \end{pmatrix}}
\newcommand\etprob[2]{\begin{pmatrix} #1 & #2 \end{pmatrix}}
\newcommand\coordpl[2]{\left(#1;#2\right)}
\newcommand\coordes[3]{\left(#1;#2;#3\right)}
\newcommand\coordeux[2]{\begin{pmatrix} #1 \\ #2 \end{pmatrix}}
\newcommand\coordve[3]{\begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}}
\newcommand\vect[1]{\vv{#1}}
\newcommand\mclp[2]{\underset{\mathclap{#2}}{#1}}

% ===================================Maths v2
\newcommand\LoiNormale[2]{%
	\mathcallig{N}{\left(#1;#2\right)}%
}
\newcommand\LoiBinomiale[2]{%
	\mathcallig{B}{\left(#1;#2\right)}%
}
\newcommand\CoordPtPl[2]{%
	{\left(#1;#2\right)}%
}
\newcommand\CoordPtEs[3]{%
	{\left(#1;#2;#3\right)}%
}
\newcommand\CoordVecPt[2]{%
	\begin{pmatrix} #1 \\ #2 \end{pmatrix}%
}
\newcommand\CoordVecEs[3]{%
	\begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}%
}
\newcommand\MatDeux[4]{%
	\begin{pmatrix} #1 & #2 \\ #3 & #4 \end{pmatrix}%
}
\intervalconfig{separator symbol=;}
\newcommand\IntervalleFF[3][scaled]{\ensuremath{\interval[#1]{#2}{#3}}}
\newcommand\IntervalleOF[3][scaled]{\ensuremath{\interval[#1,open left]{#2}{#3}}}
\newcommand\IntervalleFO[3][scaled]{\ensuremath{\interval[#1,open right]{#2}{#3}}}
\newcommand\IntervalleOO[3][scaled]{\ensuremath{\interval[#1,open]{#2}{#3}}}
\DeclareDocumentCommand\Arrondi{ s O{3} m }{% * pour afficher signe / opt = précision / argument = nb
	\IfBooleanTF{#1}{\num[print-implicit-plus]{\fpeval{round(#3,#2)}}}{\num{\fpeval{round(#3,#2)}}}
}

% ======================gras en mode (sf)math
\ifluatex
	\newcommand\grasmaths[1]{\symbf{#1}}
	\newcommand\sfbmath[1]{\symbf{\symsfup{#1}}}
\else
	\usepackage{bm}
	\newcommand\grasmaths[1]{\bm{#1}}
	\newcommand\sfbmath[1]{\bm{\mathsf{#1}}}
\fi

% ==============styles persos et mise en page
\newcommand\lycee{Lycée Edmé Bouchardon}
\definecolor{marron}{rgb}{0.64,0.16,0.16}
\definecolor{titrebleu}{rgb}{0,0,0.6}
\setlength{\parindent}{0pt}
\setlength{\headheight}{8mm}
\setlength{\headsep}{4mm}
\setlength{\footskip}{12mm}
\newcommand\numeropage{%
	\ifthenelse{\pageref{LastPage}>1}{- \thepage{} -}{}%
}

\newcommand\numeropagetot[1][/]{%
	\ifthenelse{\pageref{LastPage}>1}{- \thepage{}#1{}\pageref{LastPage} -}{}%
}

\newcommand\nomprenomtcbox{%
	\begin{tcolorbox}[enhanced,size=title,boxsep=6pt,boxrule=1pt,colframe=gray,colback=lightgray!5,left=2pt,right=2pt,sharp corners,rounded corners=downhill,arc=8pt]\textbf{\textsf{\large NOM : \dotfill~Prénom : \dotfill}}\end{tcolorbox}%
}

\newcommand\AppelProf{%
	\tcbox[size=small,on line,colback=White,left=0pt,right=0pt,boxsep=2pt]{\tuto{{\tiny \faUserTie} {\scriptsize Appel possible au professeur !}}}%
}

\newtcolorbox{fiche}{sharp corners=uphill,colback=black!66,colupper=white,fontupper=\centering \scshape \bfseries \LARGE}

\newtcolorbox{onglet}[2][]{enhanced,
	before skip=3mm,after skip=3mm,
	colback=black!5,colframe=black!80,boxrule=0.2mm,
	attach boxed title to top left={xshift=1cm,yshift*=1mm-\tcboxedtitleheight},
	varwidth boxed title*=-3cm,
	boxed title style={frame code={
			\path[fill=tcbcolback!30!black]
			([yshift=-1mm,xshift=-1mm]frame.north west)
			arc[start angle=0,end angle=180,radius=1mm]
			([yshift=-1mm,xshift=1mm]frame.north east)
			arc[start angle=180,end angle=0,radius=1mm];
			\path[left color=tcbcolback!60!black,right color=tcbcolback!80!black,
			middle color=tcbcolback!70!black]
			([xshift=-2mm]frame.north west) -- ([xshift=2mm]frame.north east)
			[rounded corners=1mm]-- ([xshift=1mm,yshift=-1mm]frame.north east)
			-- (frame.south east) -- (frame.south west)
			-- ([xshift=-1mm,yshift=-1mm]frame.north west)
			[sharp corners]-- cycle;
		},interior engine=empty,
	},
	fonttitle=\bfseries,
	title={#2},#1}

\RequirePackage{varwidth}
\newtcolorbox{blocsujet}[2][]{enhanced,size=small,halign=flush center,
	colback=white!5,colframe=marron,boxrule=1.25pt,
	attach boxed title to top left={xshift=0.5cm,yshift=1mm-\tcboxedtitleheight},
	varwidth boxed title*=-3cm,
	boxed title style={frame code={
			\path[fill=tcbcolback!30!black]
			([yshift=-1mm,xshift=-1mm]frame.north west)
			arc[start angle=0,end angle=180,radius=1mm]
			([yshift=-1mm,xshift=1mm]frame.north east)
			arc[start angle=180,end angle=0,radius=1mm];
			\path[left color=tcbcolback!60!black,right color=tcbcolback!60!black,
			middle color=tcbcolback!80!black]
			([xshift=-2mm]frame.north west) -- ([xshift=2mm]frame.north east)
			[rounded corners=1mm]-- ([xshift=1mm,yshift=-1mm]frame.north east)
			-- (frame.south east) -- (frame.south west)
			-- ([xshift=-1mm,yshift=-1mm]frame.north west)
			[sharp corners]-- cycle;
		},interior engine=empty,
	},
	fonttitle=\bfseries\sffamily,
	colupper=marron,
	fontupper=\huge\bfseries\sffamily,
	title={#2},#1}

\tcbset{sousepreuve/.style={%
		center,after skip=1pt,size=small,boxsep=3pt,boxrule=1pt,colframe=Orchid,colback=white,left=2pt,right=2pt,%
		sharp corners,rounded corners=downhill,arc=8pt,colupper=Orchid,
		fontupper={\sffamily\bfseries\large}
	}
}

\newcommand\tcsousepreuve[1][]{%
	\ifthenelse{\equal{#1}{}}{\tcbox[sousepreuve]{Épreuve \epreuve}}{}
	\ifthenelse{\equal{#1}{U21}}{\tcbox[sousepreuve,before upper=\faSortNumericDown\:\:,after upper=\:\:\faProjectDiagram]{Épreuve \epreuve}}{}
	\ifthenelse{\equal{#1}{U2}}{\tcbox[sousepreuve,before upper=\faSortNumericDown\:\:,after upper=\:\:\faProjectDiagram]{Épreuve \epreuve}}{}
	\ifthenelse{\equal{#1}{UF2}}{\tcbox[sousepreuve,before upper=\faDice\:\:,after upper=\:\:\faChartLine]{Épreuve \epreuve}}{}
}

\newtcolorbox{blocexo}[1][]{%
	enhanced,size=small,
	colback=white,colframe=titrebleu,boxrule=0.75pt,
	fontupper=\color{titrebleu}\Large\sffamily\bfseries,
	sharp corners,rounded corners=south,arc=4pt
}

\newtcolorbox{marker}[1][]{enhanced,width=7cm,before skip=2mm,after skip=3mm,fontupper=\small\sffamily,%
	boxrule=0.4pt,left=5mm,right=2mm,top=1pt,bottom=1pt,colback=yellow!15,colframe=yellow!20!black,%
	sharp corners,rounded corners=southeast,arc is angular,arc=3mm,center,%
	underlay={%
		\path[fill=tcbcolback!80!black] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
		\path[draw=tcbcolframe,shorten <=-0.05mm,shorten >=-0.05mm] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
		%\path[fill=yellow!50!black,draw=none] (interior.south west) rectangle node[midway,white]{\Large\bfseries{}!} ([xshift=3mm]interior.north west);
	},%
	drop fuzzy shadow,#1
}

% ====================================entêtes
\if@entete
	\RequirePackage[left=13mm,right=13mm,top=18mm,bottom=18mm,footskip=30pt]{geometry}
\fi
\if@noentete
	\RequirePackage[left=13mm,right=13mm,top=13mm,bottom=18mm]{geometry}
\fi
\if@exambts
	\renewcommand{\headrulewidth}{0pt}
	\RequirePackage[left=13mm,right=13mm,top=13mm,bottom=18mm]{geometry}
	\setlength{\textheight}{24.75cm}
	\setlength{\footskip}{20mm}
\fi

\newcommand\entete{\@ifstar{\entete@star}{\entete@nostar}}
\newcommand\pied{\@ifstar{\pied@star}{\pied@nostar}}

\newcommand\entete@nostar[2][0.85]{%
	\textcolor{BlueViolet}{\scriptsize\sffamily\scalebox{#1}[#1]{#2}}
}
\newcommand\pied@nostar[2][0.85]{%
	\textcolor{BlueViolet}{\scriptsize\sffamily\scalebox{#1}[#1]{#2}}
}

\newcommand\entete@star[1]{%
	\textcolor{BlueViolet}{\scriptsize #1}
}
\newcommand\pied@star[1]{%
	\textcolor{BlueViolet}{\scriptsize #1}
}

% =================lignes, pointillés, écarts
\newcommand\pointille[1][1cm]{\makebox[#1]{\dotfill}}
\newcommand\ecartp{$\vphantom{A^{2^2}A_{2_2}}$}
\newcommand\ecartg{$\vphantom{\left(\dfrac{A^{2^2}}{A_{2_2}}\right)}$}
\newcommand\decalt{\hspace*{4ex}}

% ============================rappels numérot
\newcommand\ptno[1]{\textbf{\textcolor{red}{#1.}}}
\newcommand\pta[1]{\textbf{\textcolor{blue}{#1.}}}
\newcommand\pti[1]{\textbf{\textcolor{ForestGreen}{#1.}}}

% ===============================réponses qcm
\newcommand\ReponsesQCM[2][4]{%1=nbcol, 2=listeréponses
	\setsepchar{§}%
	\readlist*\QCMListereponses{#2}%
	\IfEq{#1}{4}%4colonnes
		{%
			\begin{tblr}{width=\linewidth,colspec={*{4}{X[m,l]}}}
				\pta{a}~~\QCMListereponses[1] & \pta{b}~~\QCMListereponses[2] & \pta{c}~~\QCMListereponses[3] & \pta{d}~~\QCMListereponses[4] \\
			\end{tblr}%
		}%
		{}%
	\IfEq{#1}{3}%4colonnes
		{%
			\begin{tblr}{width=\linewidth,colspec={*{3}{X[m,l]}}}
				\pta{a}~~\QCMListereponses[1] & \pta{b}~~\QCMListereponses[2] & \pta{c}~~\QCMListereponses[3] \\
			\end{tblr}%
		}%
		{}%
	\IfEq{#1}{2}%4colonnes
		{%
			\begin{tblr}{width=\linewidth,colspec={*{2}{X[m,l]}}}
				\pta{a}~~\QCMListereponses[1] & \pta{b}~~\QCMListereponses[2] \\
				\pta{c}~~\QCMListereponses[3] & \pta{d}~~\QCMListereponses[4] \\
			\end{tblr}%
		}%
		{}%
}

% =============================titre/sections
\RequirePackage{titlesec}
\RequirePackage[fr-FR]{datetime2}
\newcommand\nomfichier{\currfilebase}
\newcommand\mois{\DTMfrenchMonthname{\@dtm@month}}
\newcommand\annee{\@dtm@year}
\newcommand\matiere{<matiere>}
\newcommand\classe{<classe>}
\newcommand\typedoc{DOC}
\newcommand\numdoc{1}
\newcommand\duree{<duree>}

\define@key{donnees}{nomfichier}{\def\donnees@nomfichier{#1}}
\define@key{donnees}{typedoc}{\def\donnees@typedoc{#1}}
\define@key{donnees}{numdoc}{\def\donnees@numdoc{#1}}
\define@key{donnees}{classe}{\def\donnees@classe{#1}}
\define@key{donnees}{matiere}{\def\donnees@matiere{#1}}
\define@key{donnees}{mois}{\def\donnees@mois{#1}}
\define@key{donnees}{annee}{\def\donnees@annee{#1}}
\define@key{donnees}{matiere}{\def\donnees@matiere{#1}}
\define@key{donnees}{duree}{\def\donnees@duree{#1}}
\define@key{donnees}{titre}{\def\donnees@titre{#1}}
\define@key{donnees}{tailletitre}{\def\donnees@tailletitre{#1}}
\define@key{donnees}{margetitre}{\def\donnees@margetitre{#1}}
\setkeys{donnees}{%
	nomfichier=\currfilebase,%
	typedoc=DOC~,%
	numdoc=1,%
	classe={<classe>},%
	matiere={<matiere>},%
	mois={\DTMfrenchMonthname{\@dtm@month}},%
	annee={\@dtm@year},%
	duree={<duree>},%
	titre=,%
	tailletitre=\huge,%
	margetitre=0cm
}
\newcommand\donnees[1][]{%
	\setkeys{donnees}{#1}
	\renewcommand\nomfichier{\donnees@nomfichier}
	\renewcommand\typedoc{\donnees@typedoc}
	\renewcommand\numdoc{\donnees@numdoc}
	\setcounter{part}{\donnees@numdoc}
	\addtocounter{part}{-1}
	\renewcommand\thepart{\ifnum\value{part}<10\relax0\fi\arabic{part}}
	\renewcommand\classe{\donnees@classe}
	\renewcommand\matiere{\donnees@matiere}
	\renewcommand\mois{\donnees@mois}
	\renewcommand\annee{\donnees@annee}
	\renewcommand\duree{\donnees@duree}
	\newcommand\titredoc{\donnees@titre}
}

\titleformat{\part}[frame]
	{\setlength\fboxrule{1pt}\color{marron}\bfseries\sffamily}
	{\filright\:\typedoc\thepart\:}
	{2pt}
	{\donnees@tailletitre\bfseries\filcenter}
	{}

\titlespacing*{\part}
	{\donnees@margetitre}
	{-1.2\baselineskip}
	{0.25\baselineskip}
	[\donnees@margetitre]

%essai v2 newdesign
\titleformat{\section}[hang]{\color{titrebleu}\LARGE\bfseries\sffamily}{\Roman{section}.}{1ex}{}
\titlespacing*{\section}{3mm}{2pt}{0.5\baselineskip}
\titleformat{\subsection}[hang]{\color{ForestGreen}\Large\bfseries\sffamily}{\hspace{6mm}\Roman{section}.\arabic{subsection}.}{1ex}{}
\titlespacing*{\subsection}{6mm}{2pt}{0.5\baselineskip}
\titleformat{\subsubsection}[hang]{\color{purple}\large\bfseries\sffamily}{\hspace{9mm}\Roman{section}.\arabic{subsection}.\alph{subsubsection}.}{1ex}{}
\titlespacing*{\subsubsection}{9mm}{2pt}{0.5\baselineskip}

% ============================listes et puces
\setenumerate[1]{font=\color{red}\bfseries}
\setenumerate[2]{font=\color{blue}\bfseries,label=\alph*.}
\setenumerate[3]{font=\color{ForestGreen}\bfseries,label=\roman*.}
%\setitemize[0]{noitemsep,topsep=1pt,itemsep=1pt}

% =======================================exos
\newcounter{numexos}
\setcounter{numexos}{0}
\newcommand\exonum[1]{\addtocounter{numexos}{1}{\textbf{\Large \textcolor{titrebleu}{Exercice \thenumexos \hfill (#1 points)}}}}

\newcommand\niveaudif[1]{$\vcenter{\hbox{\includegraphics[height=18pt]{goku_ssj#1}}}$}
\if@revgoku
	\renewcommand\exonum[2][]{%exercice... avec trait horizontal etéventuellement goku
		\ifthenelse{\equal{#2}{}}%
		{%
			\def\hrulefill{\leavevmode\leaders\hrule height 1.1pt\hfill\kern\z@}%épaisseur
			\addtocounter{numexos}{1}{\sffamily\textbf{\LARGE \textcolor{titrebleu}{Exercice \thenumexos{#1}~{\color{titrebleu}\hrulefill}}}}%
			\def\hrulefill{\leavevmode\leaders\hrule height 0.4pt\hfill\kern\z@}
		}%
		{%
			\def\hrulefill{\leavevmode\leaders\hrule height 1.1pt\hfill\kern\z@}%épaisseur
			\addtocounter{numexos}{1}{\sffamily\textbf{\LARGE \textcolor{titrebleu}{Exercice \thenumexos{#1}~{\color{titrebleu}\hrulefill}\niveaudif{#2}}}}%
			\def\hrulefill{\leavevmode\leaders\hrule height 0.4pt\hfill\kern\z@}
		}
	}
\fi

\newcommand\exogen[1]{%exercice... avec trait horizontal
	\def\hrulefill{\leavevmode\leaders\hrule height 1.1pt\hfill\kern\z@}%épaisseur
	{\sffamily\textbf{\LARGE \textcolor{titrebleu}{Exercice#1~{\color{titrebleu}\hrulefill}}}}%
	\def\hrulefill{\leavevmode\leaders\hrule height 0.4pt\hfill\kern\z@}
}

\newcommand\exotitre[1]{%... avec trait horizontal
	\def\hrulefill{\leavevmode\leaders\hrule height 1.1pt\hfill\kern\z@}%épaisseur
	{\sffamily\textbf{\LARGE \textcolor{titrebleu}{#1~{\color{titrebleu}\hrulefill}}}}%
	\def\hrulefill{\leavevmode\leaders\hrule height 0.4pt\hfill\kern\z@}
}

\if@sujet
	\renewcommand\exonum[2][]{%exercice ... avec trait horizontal et points
		\def\hrulefill{\leavevmode\leaders\hrule height 1.1pt\hfill\kern\z@}%épaisseur
		\ifthenelse{\equal{#2}{1}}%
		{%
			\def\pts{point}
		}%
		{%
			\def\pts{points}
		}
		\addtocounter{numexos}{1}{\sffamily\textbf{\LARGE \textcolor{titrebleu}{Exercice \thenumexos#1~{\color{titrebleu}\hrulefill~(#2 \pts)}}}}%
		\def\hrulefill{\leavevmode\leaders\hrule height 0.4pt\hfill\kern\z@}
	}
	\newcommand\exoannexe[1]{%annexe exercice ... avec trait horizontal et points
		\def\hrulefill{\leavevmode\leaders\hrule height 1.1pt\hfill\kern\z@}%épaisseur
		{\sffamily\textbf{\LARGE \textcolor{titrebleu}{Annexe Exercice#1~{\color{titrebleu}\hrulefill}}}}%
		\def\hrulefill{\leavevmode\leaders\hrule height 0.4pt\hfill\kern\z@}
	}
	\newcommand\exocours[1]{%question de cours avec trait horizontal et points
		\def\hrulefill{\leavevmode\leaders\hrule height 1.1pt\hfill\kern\z@}%épaisseur
		{\sffamily\textbf{\LARGE \textcolor{titrebleu}{Questions de cours~{\color{titrebleu}\hrulefill~(#1 points)}}}}%
		\def\hrulefill{\leavevmode\leaders\hrule height 0.4pt\hfill\kern\z@}
	}
	\newcommand\exogenerique[2]{%... avec trait horizontal et ce qu'on veut entre (...)
		\def\hrulefill{\leavevmode\leaders\hrule height 1.1pt\hfill\kern\z@}%épaisseur
		{\sffamily\textbf{\LARGE \textcolor{titrebleu}{#1~{\color{titrebleu}\hrulefill~(#2)}}}}%
		\def\hrulefill{\leavevmode\leaders\hrule height 0.4pt\hfill\kern\z@}
	}
\fi

% ===========================tableaux de base
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash }b{#1}} 
\newcolumntype{L}[1]{>{\raggedright\arraybackslash }b{#1}}
\newcolumntype{C}[1]{>{\centering\arraybackslash }b{#1}}
\newcolumntype{M}[1]{>{\centering\arraybackslash }m{#1}} %doublecentrée
\renewcommand{\tabularxcolumn}[1]{m{#1}}
\newcolumntype{Y}{>{\centering\arraybackslash }X}

% ========================tableau compétences
\defKV[tblcomp]{%
	liste=\def\COMPETliste{#1},%
	largeurs=\def\COMPETlargeurs{#1},%
	eval=\def\COMPETtitre{#1},%
	poltitre=\def\COMPETlegende{#1},%
	polcomp=\def\COMPETcomp{#1},%
	lignesep=\def\COMPETsep{#1}
}

\setKVdefault[tblcomp]{%
	liste={Compétence A § Compétence B § Compétence C § Compétence D § Compétence E},%
	largeurs={8.5cm § 0.5cm § 1.5cm},%comp + niv + note
	eval=DS01,%
	poltitre=\small\sffamily\bfseries,%
	polcomp=\small\sffamily,%
	lignesep=2pt,%
	centre=false
}

%pour créer le body du tableau (j'ai encore du mal avec ça...)
\long\def\CPaddto#1#2{\expandafter\def\expandafter#1\expandafter{#1#2}}

\NewDocumentCommand{\tblrcomp}{ O{} }{%
%\newcommand\tblrcomp[1][]{%
	\useKVdefault[tblcomp]
	\setKV[tblcomp]{#1}% on paramètres les nouvelles clés et on les simplifie
	\setsepchar{§}%
	\readlist*\ListeCompetences\COMPETliste
	\readlist*\ListeLargeurs\COMPETlargeurs
	%création du body v2
	\def\CPtabledatacomp{}%
	\xintFor* ##1 in {\xintSeq{1}{\ListeCompetenceslen}}\do{%
		\CPaddto\CPtabledatacomp{\ListeCompetences[\the\numexpr\therownum-1\relax] & & & & \\}%
		}
	%creation du tableau
	\ifboolKV[tblcomp]{centre}{\begin{center}}{}
	\begin{tblr}[expand=\CPtabledatacomp]%
		{%
			hlines,vlines,colspec={Q[l,m,\ListeLargeurs[1]]*{3}{Q[c,m,\ListeLargeurs[2]]}Q[c,m,\ListeLargeurs[3]]},%
			rowsep=\COMPETsep,%
			row{1}={font=\COMPETlegende,bg=lightgray!50},%
			row{2-Y}={font=\COMPETcomp},%
			row{Z}={font=\COMPETlegende,bg=white,fg=blue},%
			cell{2}{Z}={r=\the\numexpr\ListeCompetenceslen+1\relax}{},%
			cell{Z}{1}={c=4}{}
		}
		\COMPETtitre & NA & PA & A & Note \\
		\CPtabledatacomp
		NA : Non acquis  / PA : Partiellement acquis / A : Acquis & & & & \\
	\end{tblr}
	\ifboolKV[tblcomp]{centre}{\end{center}}{}
}

% =================================styles CCF
\tcbset{boxnum/.style={%
		nobeforeafter,boxsep=0pt,enhanced,width=0.8cm,top=3pt,bottom=3pt,arc=1mm,
		width=0.8cm,colback=DarkCyan,colframe=DarkCyan,colupper=white,fontupper=\bfseries
	}
}

\newcommand\deroulementccf{%
	\begin{blocccf}[orange]{Déroulement de l'épreuve}
		Cette épreuve de Contrôle en cours de Formation (\textbf{CCF}) se déroule en trois étapes :
		
		\begin{itemize}[leftmargin=*]
			\item \textbf{Étape 1 : Écrit (30 minutes)}
			
			Vous devez traiter la partie A du sujet. Pour cette partie, l’ordinateur est interdit mais la calculatrice (type \og collège \fg{} ou en \og mode examen \fg) est autorisée.
			
			\bigskip
			
			\textbf{Vous inscrirez vos réponses dans le document réponse à la fin du sujet.}
			
			\bigskip
			
			Les algorithmes à écrire peuvent être rédigés en \calg{langage naturel} ou en \calgpythonccf{}.
			
			\bigskip
			
			\textbf{À la fin de l’étape 1, votre document réponse doit être remis à la personne surveillant l’épreuve.} Vous garderez le sujet.
			
			\medskip
			
			\item \textbf{Étape 2 : sur machine (30 minutes)}
			
			Vous devez traiter la partie B du sujet à l’aide d’un ordinateur. Le langage utilisé est celui travaillé dans l’année, à savoir \calgpythonccf{}. Vous sauvegarderez votre travail sur la clé USB fournie.
			
			La durée totale pour effectuer les deux premières étapes est exactement d’une heure.
			
			\medskip
			
			\item \textbf{Étape 3 : oral (20 minutes au maximum)}
			
			Cette partie se déroule en deux temps. Tout d’abord, vous disposez de 10 minutes pour présenter votre travail de l’étape 2 puis, au cours des 10 minutes suivantes, un entretien permet de préciser votre démarche.
		\end{itemize}
		
		\textbf{À la fin de l’épreuve le sujet devra être rendu à l’examinateur.}
	\end{blocccf}%
}

\newcommand\numccf[1]{\tcbox[boxnum]{#1}}

\newtcolorbox{blocccf}[2][orange]{%
	enhanced,before skip=3mm,after skip=3mm,arc=0mm,top={\tcboxedtitleheight*3/4},
	colback=#1!15,colframe=#1!15,coltitle=white,
	attach boxed title to top left={xshift=12pt,yshift=-\tcboxedtitleheight/2},
	boxed title style={colframe=#1!75,colback=#1!75,arc=1pt},
	fonttitle=\bfseries\sffamily\large,
	title={#2}}

\newcommand\enteteccf[1]{%
	\textcolor{DarkCyan}{\LARGE\bfseries\scshape{#1}}
}

\newcommand\titreccf[2][\Huge]{%
	\textcolor{MediumPurple}{#1\bfseries\scshape{#2}}
}

\newcommand\str{\vphantom{ÉQ}}

\newcommand\tablignecc[4][]{%
	\begin{tblr}{rowsep=5pt,width=\linewidth,colspec={X[c]}}
		\hline[1.5pt,DarkCyan]
		\enteteccf{BTS SIO - Session {#4} \\ Sous-Épreuve E2 \\ \str{}Algorithmique Appliquée \\ \str{}Contrôle en Cours de Formation - #1} \\ \hline[1.5pt,DarkCyan]
		\titreccf{Sujet n°#2} \\ \titreccf{$\looparrowright$ #3 $\looparrowleft$} \\ \hline[1.5pt,MediumPurple]
	\end{tblr}
}

\newcommand\rappeltablignecc[2]{%
	\begin{tblr}{rowsep=5pt,width=\linewidth,colspec={X[c]}}
		\hline[1.5pt,MediumPurple]
		\titreccf{Sujet n°#1} \\ \titreccf{$\looparrowright$ #2 $\looparrowleft$} \\ \hline[1.5pt,MediumPurple]
	\end{tblr}
}

\tcbset{vignetteccfshell/.style={%
		fontupper={\vphantom{pf}\footnotesize\ttfamily},%
		vignettes,%
		colframe=SaddleBrown,coltitle=white,colback=SaddleBrown!5,%
		overlay={\begin{tcbclipinterior}%
				\draw[color=lightgray!50,fill=lightgray!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{SaddleBrown}{\scalebox{0.55}[0.75]{\textbf{SHELL}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\newcommand\ccfshell[1]{\tcbox[vignetteccfshell]{#1}}

\newcommand\ccfnph{\begin{tcolorbox}[enhanced,size=title,boxsep=6pt,boxrule=1pt,colframe=gray,colback=lightgray!5,left=2pt,right=2pt,sharp corners,rounded corners=downhill,arc=8pt]\textbf{\textsf{\large NOM Prénom : \dotfill~Heure de passage : \dotfill}}\end{tcolorbox}}

\newcommand\ccfnp{\begin{tcolorbox}[enhanced,size=title,width=0.66\linewidth,boxsep=6pt,boxrule=1pt,colframe=gray,colback=lightgray!5,left=2pt,right=2pt,sharp corners,rounded corners=downhill,arc=8pt]\textbf{\textsf{\large NOM Prénom : \dotfill~}}\end{tcolorbox}}

%listings CCF
\lstdefinestyle{langnat}{%
	inputencoding=utf8,
	language=Natural,
	aboveskip=0pt,belowskip=0pt,
	basicstyle=\linespread{1.25}\small\ttfamily,
	keywordstyle=\bfseries,
	keepspaces=true,
	tabsize=4,numbersep=10pt,
	numbers=none,
	showstringspaces=false,
	escapeinside={(*}{*)},
	keywords = {Alors,Algorithme,Afficher,Saisir,Faire,Si,Sinon,SinonSi,TantQue,Pour,allant,de,FinSi,FinPour,FinTantQue,ou,et,Fonctions,Fonction,Retourner,ALGORITHME,Type},
	morecomment=[l][commentstyle]{\#},
	commentstyle=\itshape\color{gray},
	classoffset=0,
	keywordstyle=\bfseries\color{blue!75},
	classoffset=1, %les variables
	morekeywords = {entier,entiers,liste,listes,tableau,tableaux,flottant,flottants},
	keywordstyle=\bfseries\color{ForestGreen!75},
	classoffset=2,
	morekeywords = {Fin,Variable,Variables},
	keywordstyle=\bfseries\color{FireBrick!75},
	classoffset=0,
	morestring=[b]",
	morestring=[b]',
	stringstyle=\color{red!75},
	literate={>=}{$\geqslant$}1 {<=}{$\leqslant$}1%
	{=}{\textleftarrow}1 {==}{=}1%
	{á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1%
	{ú}{{\'u}}1 {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1%
	{à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1%
	{À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1%
	{ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1%
	{Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1%
	{â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1%
	{Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1%
	{œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1%
	{ű}{{\H{u}}}1 {Ű}{{\H{U}}}1 {ő}{{\H{o}}}1 {Ő}{{\H{O}}}1%
	{ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1%
	{€}{{\texteuro}}1 {£}{{\pounds}}1%
	{Rôle}{{{\bfseries\color{blue!75}R{\^o}le}}}4%
	{Répéter}{{{\bfseries\color{blue!75}R\'{e}p\'{e}ter}}}7%
	{Jusqu'à}{{{\bfseries\color{blue!75}Jusqu'\`a}}}7%
	{à}{{{\bfseries\color{blue!75}\`a}}}1%
	{Début}{{{\bfseries\color{FireBrick!75}D{\'e}but}}}5%
	{utilisé}{{{\bfseries\color{blue!75}utilis{\'e}}}}7%
	{retourné}{{{\bfseries\color{blue!75}retourn{\'e}}}}8%
	{utilisés}{{{\bfseries\color{blue!75}utilis{\'e}s}}}8%
	{utilisée}{{{\bfseries\color{blue!75}utilis{\'e}e}}}8%
	{utilisées}{{{\bfseries\color{blue!75}utilis{\'e}es}}}9%
	{Paramètre}{{{\bfseries\color{blue!75}Param\`etre}}}9%
	{Paramètres}{{{\bfseries\color{blue!75}Param\`etres}}}{10}%
	{booléen}{{{\bfseries\color{ForestGreen!75}bool{\'e}en}}}7%
	{booléens}{{{\bfseries\color{ForestGreen!75}bool{\'e}ens}}}8%
	{d'entiers}{{{\bfseries\color{ForestGreen!75}d'entiers}}}9%
}

% ===================================pas-math
\ifthenelse{\isundefined{\intervFF}}
	{\newcommand*\intervFF[2]{\mbox{\ensuremath{\left[#1;#2\right]}}}}
	{\renewcommand*\intervFF[2]{\mbox{\ensuremath{\left[#1;#2\right]}}}\typeout{La commande \string\intervFF\space a deja ete redefinie.}}

\ifthenelse{\isundefined{\intervFO}}
	{\newcommand*\intervFO[2]{\mbox{\ensuremath{\left[#1;#2\right[}}}}
	{\renewcommand*\intervFO[2]{\mbox{\ensuremath{\left[#1;#2\right[}}}\typeout{La commande \string\intervFO\space a deja ete redefinie.}}

\ifthenelse{\isundefined{\intervOF}}
	{\newcommand*\intervOF[2]{\mbox{\ensuremath{\left]#1;#2\right]}}}}
	{\renewcommand*\intervOF[2]{\mbox{\ensuremath{\left]#1;#2\right]}}}\typeout{La commande \string\intervOF\space a deja ete redefinie.}}

\ifthenelse{\isundefined{\intervOO}}
	{\newcommand*\intervOO[2]{\mbox{\ensuremath{\left]#1;#2\right[}}}}
	{\renewcommand*\intervOO[2]{\mbox{\ensuremath{\left]#1;#2\right[}}}\typeout{La commande \string\intervOO\space a deja ete redefinie.}}

\ifthenelse{\isundefined{\N}}
	{\newcommand*\N{\@ifstar{\n@star}{\n@nostar}}}
	{\renewcommand*\N{\@ifstar{\n@star}{\n@nostar}}\typeout{La commande \string\N\space a ete redefinie par pas-math.}}
	\newcommand*{\n@nostar}{\ensuremath{\mathbb{N}}\xspace}
	\newcommand*{\n@star}{\ensuremath{\mathbb{N}^{*}}\xspace}

\ifthenelse{\isundefined{\Z}}
	{\newcommand*{\Z}{\@ifstar{\z@star}{\z@nostar}}}
	{\renewcommand*{\Z}{\@ifstar{\z@star}{\z@nostar}}\typeout{La commande \string\Z\space a ete redefinie par pas-math.}}
	\newcommand*{\z@nostar}{\ensuremath{\mathbb{Z}}\xspace}
	\newcommand*{\z@star}{\ensuremath{\mathbb{Z}^{*}}\xspace}

\ifthenelse{\isundefined{\D}}
	{\newcommand*{\D}{\@ifstar{\d@star}{\d@nostar}}}
	{\renewcommand*{\D}{\@ifstar{\d@star}{\d@nostar}}\typeout{La commande \string\D\space a ete redefinie par pas-math.}}
	\newcommand*{\d@nostar}{\ensuremath{\mathbb{D}}\xspace}
	\newcommand*{\d@star}{\ensuremath{\mathbb{D}^{*}}\xspace}

\ifthenelse{\isundefined{\Q}}
	{\newcommand*{\Q}{\@ifstar{\q@star}{\q@nostar}}}
	{\renewcommand*{\Q}{\@ifstar{\q@star}{\q@nostar}}\typeout{La commande \string\Q\space a ete redefinie par pas-math.}}
	\newcommand*{\q@nostar}{\ensuremath{\mathbb{Q}}\xspace}
	\newcommand*{\q@star}{\ensuremath{\mathbb{Q}^{*}}\xspace}

\ifthenelse{\isundefined{\R}}
	{\newcommand*{\R}{\@ifstar{\r@star}{\r@nostar}}}
	{\renewcommand*{\R}{\@ifstar{\r@star}{\r@nostar}}\typeout{La commande \string\R\space a ete redefinie par pas-math.}}
	\newcommand*{\r@nostar}{\ensuremath{\mathbb{R}}\xspace}
	\newcommand*{\r@star}{\ensuremath{\mathbb{R}^{*}}\xspace}

\ifthenelse{\isundefined{\C}}
	{\newcommand*{\C}{\@ifstar{\c@star}{\c@nostar}}}
	{\renewcommand*{\C}{\@ifstar{\c@star}{\c@nostar}}\typeout{La commande \string\C\space a ete redefinie par pas-math.}}
	\newcommand*{\c@nostar}{\ensuremath{\mathbb{C}}\xspace}
	\newcommand*{\c@star}{\ensuremath{\mathbb{C}^{*}}\xspace}

\ifthenelse{\isundefined{\H}}
	{\newcommand*{\H}{\@ifstar{\h@star}{\h@nostar}}}
	{\renewcommand*{\H}{\@ifstar{\h@star}{\h@nostar}}\typeout{La commande \string\H\space a ete redefinie par pas-math.}}
	\newcommand*{\h@nostar}{\ensuremath{\mathbb{H}}\xspace}
	\newcommand*{\h@star}{\ensuremath{\mathbb{H}^{*}}\xspace}

\ifthenelse{\isundefined{\Rij}}
	{\newcommand*\Rij[1][O]{\ensuremath{\left(\mathrm{#1};\vv{\imath},\vv{\jmath} \right)}}}
	{\renewcommand*\Rij[1][O]{\ensuremath{\left(\mathrm{#1};\vv{\imath},\vv{\jmath} \right)}}\typeout{La commande \string\Rij\space a ete redefinie par pas-math.}}

\newcommand\pas@Rijk[1]{%
	\begingroup	\setbox0\hbox{$\vcenter{\hbox{$\mathrm{#1};\vv{\imath},\vv{\jmath},\vv{k}$}}$}%
	\setbox1\hbox{$\mathrm{#1};\vv{\imath},\vv{\jmath},\vv{k}$}%
	\leavevmode\raise\dimexpr\dp0-\dp1\relax%
	\hbox{$\left(\box0 \right)$}%
	\endgroup
}
\ifthenelse{\isundefined{\Rijk}}
	{\newcommand*\Rijk[1][O]{\pas@Rijk{#1}}}
	{\renewcommand*\Rijk[1][O]{\pas@Rijk{#1}}\typeout{La commande \string\Rijk\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\Ruv}}
	{\newcommand*\Ruv[1][O]{\ensuremath{\left(\mathrm{O};\vv{u},\vv{v} \right)}}}
	{\renewcommand*\Ruv[1][O]{\ensuremath{\left(\mathrm{O};\vv{u},\vv{v} \right)}}\typeout{La commande \string\Ruv\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\dx}}
	{\newcommand*\dx[1][x]{\ensuremath{~\text{d}#1}}}
	{\renewcommand*\dx[1][x]{\ensuremath{~\text{d}#1}}\typeout{La commande \string\dx\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\dint}}
	{\newcommand*\dint{\displaystyle\int}}
	{\renewcommand*\dint{\displaystyle\int}\typeout{La commande \string\dint\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\e}}
	{\newcommand*\e{{\rm e}}}
	{\renewcommand*\e{{\rm e}}\typeout{La commande \string\e\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\j}}
	{\newcommand*\j{{\rm j}}}
	{\renewcommand*\j{{\rm j}}\typeout{La commande \string\j\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\jexp}}
	{\newcommand*\jexp{\ensuremath{\e^{\i\frac{\pi}{3}}}}}
	{\renewcommand*\jexp{\ensuremath{\e^{\i\frac{\pi}{3}}}}\typeout{La commande \string\jexp\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\jalg}}
	{\newcommand*\jalg{\ensuremath{\frac{1}{2}+\i\frac{\sqrt{3}}{2}}}}
	{\renewcommand*\jalg{\ensuremath{\frac{1}{2}+\i\frac{\sqrt{3}}{2}}}\typeout{La commande \string\jalg\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\esp}}
	{\newcommand*\esp[2][\mathbb{E}]{\ensuremath{#1\left({#2}\right)}}}
	{\renewcommand*\esp[2][\mathbb{E}]{\ensuremath{#1\left({#2}\right)}}\typeout{La commande \string\esp\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\var}}
	{\newcommand*\var[2][\mathbb{V}]{\ensuremath{#1\left({#2}\right)}}}
	{\renewcommand*\var[2][\mathbb{V}]{\ensuremath{#1\left({#2}\right)}}\typeout{La commande \string\var\space a ete redefinie par pas-math.}}

\ifthenelse{\isundefined{\ectype}}
	{\newcommand*\ectype[1]{\ensuremath{\sigma\left({#1}\right)}}}
	{\renewcommand*\ectype[1]{\ensuremath{\sigma\left({#1}\right)}}\typeout{La commande \string\ectype\space a ete redefinie par pas-math.}}

%==========================tcbox (on garde ?)
%--shell python tcbox--
\tcbset{pythonshell/.style={%
		size=fbox,left=1mm,right=1mm,boxsep=0pt,on line,%
		colback=green!5!white,colframe=green!75!black,%
		fontupper={\blue >{}>{}>{} }\strut\footnotesize\ttfamily}%
}

%--point calculatrice--
\newtcolorbox{pointcalc}{%
	coltitle=red!75!black,colbacktitle=black!10!white,colback=white,sharp corners=uphill,arc=12pt,title=\faCalculator{}\:\textsf{Point Calculatrice}%
}

%--point python--
\newtcolorbox{pointpython}{%
	coltitle=green!75!black,colbacktitle=black!10!white,colback=white,sharp corners=uphill,arc=12pt,title=\faPython{}\:\textsf{Point Python}%
}

%--style par défaut python--
\tcbset{cpython/.style={%
		center,boxrule=1.25pt,%
		colframe=Green,coltitle=Green!75!black,colbacktitle=black!10!white,colback=black!5,%
		sharp corners=uphill,arc=12pt,left=5pt,leftupper=25pt,rightupper=25pt,before skip=8pt,after skip=8pt}%
}

%codepythontitre
\newtcolorbox{codepython}[1][16cm]{%
	cpython,width=#1,title=\faPython{}\:\textsf{Code Python}}

%codepython
\newtcolorbox{codepythonv}[1][16cm]{%
	cpython,width=#1}

%===================================vignettes
\tcbset{vignettelogo/.style={%
		fontupper={\tiny \textcolor{Green!75!black}{\faPython}}\:\vphantom{pf}\small\ttfamily,%
		nobeforeafter,box align=base,boxsep=0pt,enhanced,sharp corners=all,rounded corners=southeast,%
		boxrule=0.75pt,left=1pt,right=1pt,top=0pt,bottom=0.25pt,%
		colframe=Green,coltitle=Green!75!black,colback=ForestGreen!5,%
		before upper = \vphantom{pf},
		underlay={\begin{tcbclipinterior}%
				\draw[color=ForestGreen!33,fill=ForestGreen!33]($(interior.south west)$) rectangle ($(interior.north west)+(7pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettes/.style={%
		nobeforeafter,box align=base,boxsep=0pt,enhanced,sharp corners=all,rounded corners=southeast,%
		boxrule=0.75pt,left=7pt,right=1pt,top=0pt,bottom=0.25pt,%
		%before upper={{\normalsize \vphantom{pf}}}
	}
}

\tcbset{vignettepy/.style={%
		fontupper={\vphantom{pf}\footnotesize\ttfamily},%
		vignettes,%
		colframe=Green,coltitle=Green!75!black,colback=ForestGreen!5,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=lightgray!50,fill=lightgray!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{Green!75!black}{\scalebox{0.55}[0.75]{\textbf{PY}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettepyccf/.style={%
		fontupper={\vphantom{pf}\footnotesize},%
		vignettes,%
		colframe=Green,coltitle=Green!75!black,colback=ForestGreen!5,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=lightgray!50,fill=lightgray!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{Green!75!black}{\scalebox{0.55}[0.75]{\textbf{PY}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettealgo/.style={%
		fontupper={\vphantom{pf}\footnotesize\ttfamily},%
		vignettes,%
		colframe=darkgray,coltitle=white,colback=darkgray!5,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=lightgray!50,fill=lightgray!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{darkgray}{\scalebox{0.55}[0.75]{\textbf{ALGO}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettetableur/.style={%
		fontupper={\vphantom{pf}\footnotesize\sffamily},%
		vignettes,%
		colframe=SeaGreen,coltitle=White,colback=White,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=SeaGreen!25,fill=SeaGreen!25]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{darkgray}{\scalebox{0.5}[0.75]{\textbf{EXCEL}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettealgopython/.style={%
		%fontupper={\vphantom{pf}\footnotesize\sffamily},%
		vignettes,%
		right=2pt,%
		colframe=darkgray,coltitle=White,colback=White,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=lightgray!50,fill=lightgray!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{darkgray}{\scalebox{0.55}[0.75]{\textbf{ALGO}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettegraph/.style={%
		fontupper={\vphantom{pf}\footnotesize\sffamily},%
		vignettes,%
		colframe=YellowGreen,coltitle=White,colback=White,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=YellowGreen!25,fill=YellowGreen!25]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{darkgray}{\scalebox{0.55}[0.75]{\textbf{GRPH}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettegraphtikz/.style={%
		vignettes,top=2pt,bottom=2pt,%
		colframe=YellowGreen,coltitle=White,colback=White,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=YellowGreen!25,fill=YellowGreen!25]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{darkgray}{\scalebox{0.55}[0.75]{\textbf{GRPH}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignetteshell/.style={%
		fontupper={\vphantom{pf}\footnotesize\sffamily},%
		vignettes,%
		colframe=Maroon,coltitle=white,colback=Maroon!5,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=lightgray!50,fill=lightgray!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{Maroon}{\scalebox{0.55}[0.75]{\textbf{SHELL}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettelatex/.style={%
		fontupper={\vphantom{pf}\footnotesize\ttfamily},
		vignettes,%
		colframe=Turquoise,coltitle=white,colback=Turquoise!5,%
		underlay={\begin{tcbclipinterior}%
				\fill[fill=lightgray!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{Turquoise}{\scalebox{0.6}[0.75]{\textbf{\LaTeX}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettexcas/.style={%
		fontupper={\vphantom{pf}\footnotesize\sffamily},
		vignettes,%
		colframe=OrangeRed,coltitle=white,colback=OrangeRed!5,%
		underlay={\begin{tcbclipinterior}%
				\fill[fill=lightgray!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{OrangeRed}{\scalebox{0.55}[0.75]{\textbf{XCAS}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettecrypt/.style={%
		fontupper={\vphantom{pf}\footnotesize\ttfamily},
		vignettes,%
		left=10pt,right=2pt,colframe=Goldenrod,coltitle=white,colback=Goldenrod!5,%
		underlay={\begin{tcbclipinterior}%
				\draw[Goldenrod!25,fill=Goldenrod!25]($(interior.south west)$) rectangle node[]{\tiny \textcolor{Goldenrod!75!Black}{\scalebox{0.95}[1]{\faKey}}} ($(interior.north west)+(8pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettesoluce/.style={%
		fontupper={\vphantom{pf}\footnotesize},%
		vignettes,%
		top=1.25pt,bottom=1.25pt,left=10pt,right=2pt,%
		colframe=Lavender,coltitle=white,colback=Lavender!5,%
		underlay={\begin{tcbclipinterior}%
				\draw[Lavender!25,fill=Lavender!25]($(interior.south west)$) rectangle node[]{\tiny \textcolor{Lavender!75!Black}{\scalebox{0.95}[1]{\faCheckCircle}}} ($(interior.north west)+(8pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\newcommand\calg[1]{\tcbox[vignettealgo]{#1}}
\newcommand\cpyl[1]{\tcbox[vignettelogo]{#1}}
\newcommand\cpy[1]{\tcbox[vignettepy]{#1}}
\newcommand\cpyccf[1]{\tcbox[vignettepyccf]{\pyv{#1}}}
\newcommand\cgrph[1]{\tcbox[vignettegraph]{#1}}
\newcommand\cgrphtikz[1]{\tcbox[vignettegraphtikz]{#1}}
\newcommand\cxcas[1]{\tcbox[vignettexcas]{#1}}
\newcommand\cshell[1]{\tcbox[vignetteshell]{#1}}
\newcommand\ctex[1]{\tcbox[vignettelatex]{#1}}
\newcommand\ccrypt[1]{\tcbox[vignettecrypt]{#1}}
\newcommand\csoluce[1]{\tcbox[vignettesoluce]{#1}}
\newcommand\csheet[1]{\tcbox[vignettetableur]{#1}}
\newcommand\calgpython{\tcbox[vignettealgopython]{$\vcenter{\hbox{\includegraphics[height=0.78\baselineskip]{logopython}}}$}}
\newcommand\calgscratch{\tcbox[vignettealgopython]{$\vcenter{\hbox{\includegraphics[height=0.78\baselineskip]{logoscratch}}}$}}
\newcommand\calgpythonccf{\tcbox[vignettealgopython]{$\vcenter{\hbox{\includegraphics[height=0.5\baselineskip]{logopython}}}$}}

\tcbset{vignettecalc/.style={%
		fontupper={\vphantom{pf}\footnotesize\bfseries\ttfamily},%
		nobeforeafter,box align=base,boxsep=0pt,enhanced,sharp corners=all,rounded corners=southeast,%
		boxrule=0.75pt,left=7pt,right=1pt,top=0pt,bottom=0.25pt,%
		colframe=Indigo,coltitle=Indigo!75!black,colback=White
	}
}

\tcbset{vignettecasio/.style={%
		underlay={\begin{tcbclipinterior}%
				\draw[color=Indigo!33,fill=Indigo!33]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{Indigo!75!black}{\scalebox{0.5}[0.75]{\textbf{CASIO}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettetexcas/.style={%
		underlay={\begin{tcbclipinterior}%
				\draw[color=Indigo!33,fill=Indigo!33]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{Indigo!75!black}{\scalebox{0.5}[0.75]{\textbf{TEXAS}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettetenwks/.style={%
		fontupper={\vphantom{pf}\scriptsize\fontnwks},%
		nobeforeafter,box align=base,boxsep=0pt,enhanced,sharp corners=all,rounded corners=southeast,%
		boxrule=0.75pt,left=7pt,right=1pt,top=0pt,bottom=0.25pt,%
		colframe=Indigo,coltitle=Indigo!75!black,colback=White,
		underlay={\begin{tcbclipinterior}%
				\draw[color=Indigo!33,fill=Indigo!33]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{Indigo!75!black}{\scalebox{0.5}[0.75]{\textbf{NWKS}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{vignettecalculatrice/.style={%
		underlay={\begin{tcbclipinterior}%
				\draw[color=Indigo!33,fill=Indigo!33]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{Indigo!75!black}{\scalebox{0.5}[0.75]{\textbf{CALC.}}}}} ($(interior.north west)+(5pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\newcommand\ccalc[1]{\tcbox[vignettecalc,vignettecasio]{#1}} %vignette CASIO
\newcommand\ccalt[1]{\tcbox[vignettecalc,vignettetexcas]{#1}} %vignette TEXAS
\newcommand\ccaln[1]{\tcbox[vignettetenwks]{#1}} %vignette TNWKS
\newcommand\ccalg[1]{\tcbox[vignettecalc,vignettecalculatrice]{#1}} %vignette générique

%=================================algorithmes
\tcbset{pseudocode/.style={%
		fontupper=\small\sffamily,%
		enhanced,center,boxrule=1.25pt,%
		sharp corners=all,rounded corners=southeast,arc=6pt,before skip=12pt,after skip=12pt,%
		leftupper=15pt,top=1mm,bottom=1mm,rightupper=4pt,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=lightgray!50,fill=lightgray!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{darkgray}{\scalebox{1.5}[1]{\textbf{\faFileCode\:Pseudo-Code}}}}} ($(interior.north west)+(12pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\tcbset{pythoncode/.style={%
		enhanced,center,boxrule=1.25pt,%
		sharp corners=all,rounded corners=southeast,arc=6pt,before skip=12pt,after skip=12pt,%
		leftupper=30pt,top=1mm,bottom=1mm,rightupper=4pt,%
		underlay={\begin{tcbclipinterior}%
				\draw[color=ForestGreen!50,fill=ForestGreen!50]($(interior.south west)$) rectangle node[rotate=90]{\tiny \sffamily{\textcolor{ForestGreen}{\scalebox{1.5}[1]{\textbf{\faPython\:Code Python}}}}} ($(interior
				.north west)+(12pt,0pt)$);%
		\end{tcbclipinterior}}
	}
}

\newtcolorbox{pytcode}[1][\linewidth]{width=#1,pythoncode,colframe=Green,colback=ForestGreen!5}
\newtcolorbox{pcode}[1][12cm]{width=#1,pseudocode,colframe=darkgray,colback=lightgray!5}

\ifluatex
	\tcbuselibrary{listings}
	\lstdefinelanguage{Natural}{%
		keywords={},
		inputencoding=utf8,
		comment=[l]{}}
\else
	\tcbuselibrary{listingsutf8}
	\lstdefinelanguage{Natural}{%
		keywords={},
		inputencoding=utf8/latin1,
		comment=[l]{}}
\fi

\lstdefinestyle{pseudocode}{%
	language=Natural,
	basicstyle=\footnotesize\ttfamily,
	numberstyle=\scriptsize\ttfamily\color{gray},
	keywordstyle=\bfseries,
	stringstyle=\color{red!75},
	keepspaces=true,
	tabsize=4,numbersep=10pt,
	xleftmargin=20pt,
	numbers=left,
	morestring=[b]",
	showstringspaces=false,
	escapeinside={(*}{*)}
}

\lstdefinestyle{pseudocodeno}{%
	language=Natural,
	basicstyle=\footnotesize\ttfamily,
	numberstyle=\scriptsize\ttfamily\color{gray},
	keywordstyle=\bfseries,
	stringstyle=\color{red!75},
	keepspaces=true,
	tabsize=4,numbersep=10pt,
	numbers=none,
	showstringspaces=false,
	morestring=[b]",
	escapeinside={(*}{*)}
}

\tcbset{stylelatexcode/.style={%
		enhanced,center,boxrule=1.25pt,%
		sharp corners=downhill,arc=12pt,%
		before skip=12pt,after skip=12pt,%
		leftupper=8pt,top=10pt,bottom=2pt,rightupper=4pt,%
		attach boxed title to top right={yshift=-\tcboxedtitleheight},
		boxed title style={
			size=small,colback=Turquoise!25,boxrule=1.25pt,
			colframe=Turquoise,boxsep=1.25pt,sharp corners=downhill,
			arc=12pt,top=2pt,bottom=1pt,left=6pt,right=6pt
		},
		fonttitle=\color{Turquoise}\ttfamily\footnotesize,
		title={\scriptsize\faStackOverflow}\:\textit{Code} \LaTeX\vphantom{y},
		watermark text={\faStackOverflow},watermark opacity=0.175,watermark zoom=0.50
	}
}

\newtcolorbox{tclatexcode}[1][\linewidth]{%
	width=#1,stylelatexcode,colframe=Turquoise,colback=Turquoise!5,%
	fontlower=\small
}

\tcbset{styleshellcode/.style={%
		enhanced,center,boxrule=1.25pt,%
		%sharp corners=all,rounded corners=southeast,%
		sharp corners=downhill,arc=12pt,before skip=12pt,after skip=12pt,%
		leftupper=8pt,top=10pt,bottom=2pt,rightupper=4pt,%
		attach boxed title to top right={yshift=-\tcboxedtitleheight},
		boxed title style={
			size=small,colback=Sienna!25,boxrule=1.25pt,
			colframe=Sienna,boxsep=1.25pt,
			sharp corners=downhill,arc=12pt,
			top=2pt,bottom=1pt,left=6pt,right=6pt
		},
		fonttitle=\color{Sienna}\itshape\ttfamily\footnotesize,
		title={\scriptsize\faTerminal}\:Code Shell\vphantom{y},
		watermark text={\faTerminal},watermark opacity=0.175,watermark zoom=0.50
	}
}

\newtcolorbox{tcshellcode}[1][\linewidth]{%
	width=#1,styleshellcode,colframe=Sienna,colback=Sienna!5,%
}

\tcbset{stylepseudocode/.style={%
		enhanced,center,boxrule=1.25pt,sharp corners=downhill,arc=12pt,
		before skip=12pt,after skip=12pt,leftupper=5pt,top=8pt,bottom=2pt,rightupper=4pt,%
		attach boxed title to top right={yshift=-\tcboxedtitleheight},
		boxed title style={
			size=small,colback=gray!25,boxrule=1.25pt,
			colframe=darkgray,boxsep=1.25pt,
			sharp corners=downhill,
			arc=12pt,
			top=2pt,bottom=1pt,left=6pt,right=6pt
		},
		fonttitle=\color{darkgray}\ttfamily\footnotesize,
		title={\scriptsize\faFileCode}\:\textit{Pseudo-Code}\vphantom{y},
		watermark text={\faCode},watermark opacity=0.175,watermark zoom=0.50,
	}
}

\tcbset{stylepythoncode/.style={%
		enhanced,center,boxrule=1.25pt,%
		sharp corners=downhill,arc=12pt,
		before skip=12pt,after skip=12pt,%
		leftupper=25pt,top=10pt,bottom=1mm,rightupper=4pt,%
		attach boxed title to top right={yshift=-\tcboxedtitleheight},
		boxed title style={
			size=small,colback=ForestGreen!25,boxrule=1.25pt,
			colframe=Green,boxsep=1.25pt,
			sharp corners=downhill,
			arc=12pt,
			top=2pt,bottom=1pt,left=6pt,right=6pt
		},
		fonttitle=\color{ForestGreen}\itshape\ttfamily\footnotesize,
		title={\scriptsize\faPython}\:Code Python\vphantom{y},
		watermark text={\faPython},watermark opacity=0.175,watermark zoom=0.50
	}
}

\tcbset{stylepythoncodeno/.style={%
		enhanced,center,boxrule=1.25pt,%
		sharp corners=downhill,arc=12pt,
		before skip=12pt,after skip=12pt,%
		leftupper=8pt,top=10pt,bottom=1mm,rightupper=4pt,%
		attach boxed title to top right={yshift=-\tcboxedtitleheight},
		boxed title style={
			size=small,colback=ForestGreen!25,boxrule=1.25pt,
			colframe=Green,boxsep=1.25pt,
			sharp corners=downhill,
			arc=12pt,
			top=2pt,bottom=1pt,left=6pt,right=6pt
		},
		fonttitle=\color{ForestGreen}\itshape\ttfamily\footnotesize,
		title={\scriptsize\faPython}\:Code Python\vphantom{y},
		watermark text={\faPython},watermark opacity=0.175,watermark zoom=0.50
	}
}

\tcbset{stylejupytercode/.style={%
		enhanced,center,boxrule=1.25pt,%
		sharp corners=downhill,arc=12pt,
		before skip=12pt,after skip=12pt,%
		leftupper=25pt,top=12pt,bottom=1mm,rightupper=4pt,%
		attach boxed title to top right={yshift=-\tcboxedtitleheight},
		boxed title style={
			size=small,colback=white!25,boxrule=1.25pt,
			colframe=Green,boxsep=1.25pt,
			sharp corners=downhill,
			arc=12pt,
			top=2pt,bottom=1pt,left=6pt,right=6pt
		},
		fonttitle=\color{OliveGreen}\itshape\ttfamily\footnotesize,
		title={\scriptsize\faQrcode}\:Code Jupyter\vphantom{y},
		watermark text={\faQrcode},watermark opacity=0.175,watermark zoom=0.50
	}
}

\newtcolorbox{tcjupytercode}[1][\linewidth]{%
	width=#1,stylejupytercode,colframe=OliveGreen,colback=white
}

\newtcolorbox{tcpythoncode}[1][\linewidth]{%
	width=#1,stylepythoncode,colframe=Green,colback=ForestGreen!5,%
	fontlower=\small,%
	before upper = \renewcommand{\theFancyVerbLine}{\scriptsize\ttfamily\color{Green}\arabic{FancyVerbLine}}}

\newtcolorbox{tcpythoncodeno}[1][\linewidth]{%
	width=#1,stylepythoncodeno,colframe=Green,colback=ForestGreen!5,%
	fontlower=\small,%
	before upper = \renewcommand{\theFancyVerbLine}{\scriptsize\ttfamily\color{Green}\arabic{FancyVerbLine}}}

\newtcblisting{pythonminted}[2][\linewidth]{%
	listing engine=minted,minted style=colorful,
	minted language=python,listing only,
	minted options={tabsize=4,fontsize=\small,#2},
	width=#1,colframe=Green,colback=ForestGreen!5,%
	enhanced,center,boxrule=1.25pt,
	sharp corners=downhill,arc=12pt,
	before skip=12pt,after skip=12pt,%
	leftupper=8pt,top=10pt,bottom=4pt,rightupper=4pt,%
	attach boxed title to top right={yshift=-\tcboxedtitleheight},
	boxed title style={
		size=small,colback=ForestGreen!25,boxrule=1.25pt,
		colframe=Green,boxsep=1.25pt,
		sharp corners=downhill,
		arc=12pt,
		top=2pt,bottom=1pt,left=6pt,right=6pt
	},
	fonttitle=\color{ForestGreen}\itshape\ttfamily\footnotesize,
	title={\scriptsize\faPython}\:Code Python\vphantom{y},
	watermark text={\faPython},watermark opacity=0.175,watermark zoom=0.50
}

\newcommand\keywordstyle[1]{{\bfseries{#1}}}%
\ifluatex
	\newcommand\algomathtt[1]{\symtt{#1}}
\else
	\newcommand\algomathtt[1]{\mathtt{#1}}
\fi

\newtcblisting{tcpseudocode}[1][12cm]{%
	width=#1,
	stylepseudocode,
	listing only,listing engine=listings,
	listing options={
		style=pseudocode,
		morekeywords={Alors,Variables,Algorithme,Debut,Fin,Afficher,Saisir,Faire,faire,Si,Sinon,SinonSi,Tant,TantQue,Que,Pour,allant,de,FinSi,FinPour,FinTantQue,ou,et,Fonctions,Fonction,Retourner,ALGORITHME},%
		aboveskip=2pt,belowskip=2pt,
		extendedchars=true,
		columns=flexible,
		literate={é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1% 
		{ú}{{\'u}}1 {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1%
		{è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1%
		{À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1%
		{ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1%
		{Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1%
		{â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1%
		{Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1%
		{œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1%
		{ű}{{\H{u}}}1 {Ű}{{\H{U}}}1 {ő}{{\H{o}}}1 {Ő}{{\H{O}}}1%
		{ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1%
		{€}{{\texteuro}}1 {£}{{\pounds}}1%
		{Rôle}{{\keywordstyle{R{\^o}le}}}4%
		{Répéter}{{\keywordstyle{R\'{e}p\'{e}ter}}}7%
		{à}{{\keywordstyle{\`a}}}1%
		{Jusqu'à}{{\keywordstyle{Jusqu'\`a}}}7%
		{Début}{{\keywordstyle{D{\'e}but}}}5%
		{utilisée}{{\keywordstyle{utilis{\'e}e}}}8%
		{utilisées}{{\keywordstyle{utilis{\'e}es}}}9%
		{Paramètres}{{\keywordstyle{Param\`etres}}}9%
		{>=}{>=}2 {<=}{<=}2%
		{=}{\textleftarrow}1 {==}{=}1%
	}
}

\newtcblisting{tcpseudocodeno}[1][12cm]{%
	width=#1,
	stylepseudocode,
	listing only,listing engine=listings,
	listing options={
		style=pseudocodeno,
		morekeywords={Alors,Variables,Algorithme,Debut,Fin,Afficher,Saisir,Faire,faire,Si,Sinon,SinonSi,Tant,Que,TantQue,Pour,allant,de,FinSi,FinPour,FinTantQue,ou,et,Fonctions,Fonction,Retourner,ALGORITHME},%
		aboveskip=2pt,belowskip=2pt,
		columns=fullflexible,
		literate={é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1% 
		{ú}{{\'u}}1 {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1%
		{è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1%
		{À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1%
		{ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1%
		{Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1%
		{â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1%
		{Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1%
		{œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1%
		{ű}{{\H{u}}}1 {Ű}{{\H{U}}}1 {ő}{{\H{o}}}1 {Ő}{{\H{O}}}1%
		{ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1%
		{€}{{\texteuro}}1 {£}{{\pounds}}1%
		{Rôle}{{\keywordstyle{R{\^o}le}}}4%
		{Répéter}{{\keywordstyle{R\'{e}p\'{e}ter}}}7%
		{à}{{\keywordstyle{\`a}}}1%
		{Jusqu'à}{{\keywordstyle{Jusqu'\`a}}}7%
		{Début}{{\keywordstyle{D{\'e}but}}}5%
		{utilisée}{{\keywordstyle{utilis{\'e}e}}}8%
		{utilisées}{{\keywordstyle{utilis{\'e}es}}}9%
		{Paramètres}{{\keywordstyle{Param\`etres}}}9%
		{>=}{>=}2 {<=}{<=}2%
		{=}{\textleftarrow}1 {==}{=}1%
		%{>=}{$\algomathtt{\geqslant}$}1 {<=}{$\algomathtt{\leqslant}$}1%
		%{*}{$\algomathtt{\times}$}{1}%
	}
}

%============================envts simplifiés
%\RequirePackage{fancyvrb}
%\RequirePackage{minted}
\DefineVerbatimEnvironment{VShell}{Verbatim}{fontsize=\footnotesize,tabsize=4}
\DefineVerbatimEnvironment{VLatex}{Verbatim}{fontsize=\footnotesize,tabsize=4}

\newenvironment{envlatex}[2][15cm]{%
	\VerbatimEnvironment
	\begin{tclatexcode}[#1]%
		\begin{VLatex}[#2]%
		}
		{
		\end{VLatex}%
	\end{tclatexcode}%
}

\newenvironment{envlatexminted}[1][15cm]{%
	\VerbatimEnvironment
	\begin{tclatexcode}[#1]%
		\begin{minted}[fontsize=\footnotesize,autogobble,tabsize=4,breaklines=true,breakafter=\}]{latex}%
		}
		{
		\end{minted}%
	\end{tclatexcode}%
}

\newenvironment{envshell}[2][15cm]{%
	\VerbatimEnvironment
	\begin{tcshellcode}[#1]%
		\begin{VShell}[#2]%
		}
		{
		\end{VShell}%
	\end{tcshellcode}%
}

\RequirePackage{fvextra}

\newenvironment{envpython}[1][15cm]{%
	\VerbatimEnvironment
	\begin{tcpythoncode}[#1]
		\begin{pyverbatim}[][fontsize=\footnotesize,numbers=left,numbersep=10pt,commandchars=\\\{\},mathescape]
		}
		{
		\end{pyverbatim}%
	\end{tcpythoncode}%
}

\newenvironment{envpythonnoline}[1][15cm]{%
	\VerbatimEnvironment
	\begin{tcpythoncodeno}[#1]
		\begin{pyverbatim}[][numbers=none,numbersep=0pt,fontsize=\footnotesize,commandchars=\\\{\},mathescape]
		}
		{
		\end{pyverbatim}%
	\end{tcpythoncodeno}%
}

\newtcblisting{codelatex}[1][]{%
	colback=white,colframe=red!75!black,title=\faCode{} Code \LaTeX,fonttitle=\small\sffamily\bfseries,fontlower=\footnotesize,%
	left=3pt,right=3pt,top=2pt,bottom=2pt,#1,%
	listing engine=minted,minted options={tabsize=4,fontsize=\footnotesize,autogobble}%
}

%=============================boîtes de cours
\RequirePackage{fontawesome5}

\if@newstyle

%les compteurs et utiles
\definecolor{titrebleu}{rgb}{0,0,0.6}
\newcounter{MaquetteExo}%Numéro des exercices
\setcounter{MaquetteExo}{0}%
\newcounter{MaquetteDefi}%Numéro des définitions
\setcounter{MaquetteDefi}{0}%
\newcounter{MaquetteHumour}%Numéro des humours
\setcounter{MaquetteHumour}{0}%
\newcounter{MaquetteProp}%Numéro des props
\setcounter{MaquetteProp}{0}%
\newcounter{MaquetteCscq}%Numéro des props
\setcounter{MaquetteCscq}{0}%
\newcounter{MaquetteThm}%Numéro des props
\setcounter{MaquetteThm}{0}%
\newcounter{MaquetteLog}%Numéro des props
\setcounter{MaquetteLog}{0}%
\newcounter{MaquetteHistoire}%Numéro des 
\setcounter{MaquetteHistoire}{0}%
\newcounter{MaquetteRemarque}%Numéro des 
\setcounter{MaquetteRemarque}{0}%
\newcounter{MaquetteExemple}%Numéro des 
\setcounter{MaquetteExemple}{0}%
\newcounter{MaquetteVocabulaire}%Numéro des 
\setcounter{MaquetteVocabulaire}{0}%
\newcounter{MaquetteNotation}%Numéro des 
\setcounter{MaquetteNotation}{0}%
\newcounter{MaquetteCadre}%Numéro des 
\setcounter{MaquetteCadre}{0}%
\newcounter{MaquetteIdee}%Numéro des 
\setcounter{MaquetteIdee}{0}%
\newcounter{MaquetteIntro}%Numéro des 
\setcounter{MaquetteIntro}{0}%
\newcounter{MaquetteIllustration}%Numéro des 
\setcounter{MaquetteIllustration}{0}%
\newcounter{MaquetteVideo}%Numéro des 
\setcounter{MaquetteVideo}{0}%
\newcounter{MaquetteBilan}%Numéro des 
\setcounter{MaquetteBilan}{0}%
\newcounter{MaquetteMethode}%Numéro des 
\setcounter{MaquetteMethode}{0}%
\newcounter{MaquetteTuto}%Numéro des 
\setcounter{MaquetteTuto}{0}%
\newcounter{MaquetteManipulation}%Numéro des 
\setcounter{MaquetteManipulation}{0}%
\newcounter{MaquetteCalculatrice}%Numéro des 
\setcounter{MaquetteCalculatrice}{0}%
\newcounter{MaquetteOutil}%Numéro des 
\setcounter{MaquetteOutil}{0}%
\newcounter{MaquetteAsavoir}%Numéro des 
\setcounter{MaquetteAsavoir}{0}%
\newcounter{MaquetteTD}%Numéro des 
\setcounter{MaquetteTD}{0}%
\newcounter{MaquetteAvousdejouer}%Numéro des 
\setcounter{MaquetteAvousdejouer}{0}%
\newcounter{MaquetteRappel}%Numéro des 
\setcounter{MaquetteRappel}{0}%
\newcounter{MaquetteResolution}%Numéro des 
\setcounter{MaquetteResolution}{0}%
\newcounter{MaquetteAttention}%Numéro des 
\setcounter{MaquetteAttention}{0}%
\newcounter{MaquetteCode}%Numéro des 
\setcounter{MaquetteCode}{0}%
\newcounter{MaquettePython}%Numéro des 
\setcounter{MaquettePython}{0}%
\newcounter{MaquetteDemo}%Numéro des 
\setcounter{MaquetteDemo}{0}%
\newcounter{MaquetteAlgo}%Numéro des 
\setcounter{MaquetteAlgo}{0}%
\newcounter{MaquetteScratch}%Numéro des 
\setcounter{MaquetteScratch}{0}%
\newcounter{MaquetteReponse}%Numéro des 
\setcounter{MaquetteReponse}{0}%
\newcounter{MaquetteAide}%Numéro des 
\setcounter{MaquetteAide}{0}%

\defKV[Boites]{%
	ComplementTitre=\def\BoxCpltTitle{#1},%
	NivDiff=\def\BoxNivDiff{#1},%
	Points=\def\BoxBaremeExo{#1},%
	SousTitre=\def\BoxSubTitle{#1},%
	Logo=\def\BoxLogo{#1},%
	Modele=\def\BoxModCalc{#1}
}
\setKVdefault[Boites]{%
	Pluriel=false,%
	ComplementTitre={},%
	NivDiff={},%
	Points={},%
	SousTitre={},
	Compteur=true,%
	Logo={},%
	Modele={}
}

\if@breakable
	\tcbset{baseboite/.style={
		enhanced,sharp corners=uphill,boxrule=1.25pt,%
		before skip=1.125em,after skip=1.125em,breakable,colback=white,top=3mm
		}%
	}
\else
	\tcbset{baseboite/.style={
		enhanced,sharp corners=uphill,boxrule=1.25pt,%
		before skip=1.125em,after skip=1.125em,colback=white,top=3mm
		}%
	}
\fi

\NewDocumentCommand\TitreBoite{ m m m m }{%1=color,%2=icone,%3=nom,%4=compteur
	\node[fill=white,anchor=west,xshift=4mm,text=#1!25!Black,font=\bfseries] at (frame.north west) {#2~\titrebox{\policetititreboite #3\ifboolKV[Boites]{Pluriel}{s}{}\ifboolKV[Boites]{Compteur}{~#4}{}\IfStrEq{\BoxCpltTitle}{}{}{\BoxCpltTitle}}} ;
}

\NewDocumentCommand\SousTitreBoite{ }{%
	\node[fill=white,anchor=east,xshift=-4mm,text=red!75!black,font=\bfseries\policetititreboite] at (frame.north east) {\BoxSubTitle};
}

\NewDocumentCommand\niveaudifgoku{ m }{%
	$\vcenter{\hbox{\includegraphics[height=24pt]{goku_ssj#1}}}$%
}

\NewDocumentCommand\NiveauDifficulte{ }{%
	\node[fill=white,inner sep=2pt] at (frame.west) {\niveaudifgoku{\BoxNivDiff}} ;
}

\NewDocumentCommand\LogoCoinDroit{ }{%
	\begin{tcbclipinterior}\node[opacity=0.33,rotate=-45] at ($(interior.south east)+(-10pt,10pt)$){\includegraphics[height=24pt]{\BoxLogo}};\end{tcbclipinterior}%
}

\NewDocumentCommand\ModeleCoinDroit{ }{%
	\begin{tcbclipinterior}\node[opacity=0.33,rotate=-45] at ($(interior.south east)+(-10pt,10pt)$){\includegraphics[height=48pt]{\BoxModCalc}};\end{tcbclipinterior}%
}

\NewDocumentCommand\BaremeBoite{ }{%
	\node[fill=white,anchor=east,xshift=-4mm,text=red!75!black,font=\bfseries] at (frame.north east) {\titrebox{\policetititreboite (\num{\BoxBaremeExo} point\xintifboolexpr{\BoxBaremeExo > 1}{s}{})}};
}

\NewDocumentEnvironment{cdefi}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteDefi}}{}%
	\tcolorbox[%
		baseboite,colframe=ForestGreen,%
		overlay unbroken and first={%
			\TitreBoite{ForestGreen}{\faIcon[regular]{comment-dots}}{Définition}{\theMaquetteDefi}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
			
		}%
	]%
}%
{\endtcolorbox}%

\NewDocumentEnvironment{cexo}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteExo}}{}%
	\tcolorbox[%
		baseboite,colframe=MidnightBlue,%
		overlay={%
			\TitreBoite{MidnightBlue}{\faHubspot}{Exercice}{\theMaquetteExo}
			\IfStrEq{\BoxNivDiff}{}{}{\NiveauDifficulte}%
			\IfStrEq{\BoxBaremeExo}{}{}{\BaremeBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{chumour}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteHumour}}{}%
	\tcolorbox[%
		baseboite,colframe=Yellow,%
		overlay unbroken and first={%
			\TitreBoite{Yellow}{\faIcon[regular]{laugh-wink}}{Humour}{\theMaquetteHumour}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cprop}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteProp}}{}%
	\tcolorbox[%
		baseboite,colframe=Salmon,%
		overlay unbroken and first={%
			\TitreBoite{Salmon}{\faCog}{Propriété}{\theMaquetteProp}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{ccscq}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteCscq}}{}%
	\tcolorbox[%
		baseboite,colframe=Salmon,%
		overlay unbroken and first={%
			\TitreBoite{Salmon}{\faArrowAltCircleRight[regular]}{Conséquence}{\theMaquetteCscq}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cthm}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteThm}}{}%
	\tcolorbox[%
		baseboite,colframe=FireBrick,%
		overlay unbroken and first={%
			\TitreBoite{FireBrick}{\faBullhorn}{Théorème}{\theMaquetteThm}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{chistoire}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteHistoire}}{}%
	\tcolorbox[%
		baseboite,colframe=Chocolate,%
		overlay unbroken and first={%
			\TitreBoite{Chocolate}{\faUniversity}{Point histoire}{\theMaquetteHistoire}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{crmq}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteRemarque}}{}%
	\tcolorbox[%
		baseboite,colframe=MidnightBlue,%
		overlay unbroken and first={%
			\TitreBoite{MidnightBlue}{\faHandPointRight[regular]}{Remarque}{\theMaquetteRemarque}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cexemple}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteExemple}}{}%
	\tcolorbox[%
		baseboite,colframe=MediumTurquoise,%
		overlay unbroken and first={%
			\TitreBoite{MediumTurquoise}{faHubspot}{Exemple}{\theMaquetteExemple}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cvoc}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteVocabulaire}}{}%
	\tcolorbox[%
		baseboite,colframe=YellowGreen,%
		overlay unbroken and first={%
			\TitreBoite{YellowGreen}{\faList*[regular]}{Vocabulaire}{\theMaquetteVocabulaire}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cnota}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteNotation}}{}%
	\tcolorbox[%
		baseboite,colframe=YellowGreen,%
		overlay unbroken and first={%
			\TitreBoite{YellowGreen}{\faList*}{Notation}{\theMaquetteNotation}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{ccadre}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteCadre}}{}%
	\tcolorbox[%
		baseboite,colframe=Peru,%
		overlay unbroken and first={%
			\TitreBoite{Peru}{\faInfoCircle}{Cadre}{\theMaquetteCadre}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cidee}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteIdee}}{}%
	\tcolorbox[%
		baseboite,colframe=LightBlue,%
		overlay unbroken and first={%
			\TitreBoite{LightBlue}{\faInfo}{Idée}{\theMaquetteIdee}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cintro}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteIntro}}{}%
	\tcolorbox[%
		baseboite,colframe=LightSalmon,%
		overlay unbroken and first={%
			\TitreBoite{LightSalmon}{\faMarker}{Idée}{\theMaquetteIntro}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cillustr}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteIllustration}}{}%
	\tcolorbox[%
		baseboite,colframe=Crimson,%
		overlay unbroken and first={%
			\TitreBoite{Crimson}{\faChartLine}{Illustration}{\theMaquetteIllustration}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cvideo}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteVideo}}{}%
	\tcolorbox[%
		baseboite,colframe=teal,%
		overlay unbroken and first={%
			\TitreBoite{teal}{\faIcon[regular]{file-video}}{Illustration}{\theMaquetteVideo}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cbilan}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteBilan}}{}%
	\tcolorbox[%
		baseboite,colframe=Purple,%
		overlay unbroken and first={%
			\TitreBoite{Purple}{\faForward}{Bilan}{\theMaquetteBilan}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%


\NewDocumentEnvironment{cmethode}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteMethode}}{}%
	\tcolorbox[%
		baseboite,colframe=Coral,%
		overlay unbroken and first={%
			\TitreBoite{Coral}{\faTasks}{Méthode}{\theMaquetteMethode}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{ctuto}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteTuto}}{}%
	\tcolorbox[%
		baseboite,colframe=Coral,%
		overlay unbroken and first={%
			\TitreBoite{Coral}{\faTerminal}{Tuto}{\theMaquetteTuto}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cmanip}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteManipulation}}{}%
	\tcolorbox[%
		baseboite,colframe=DarkCyan,%
		overlay unbroken and first={%
			\TitreBoite{DarkCyan}{\faCodeBranch}{Manipulation}{\theMaquetteManipulation}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{ccalco}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteCalculatrice}}{}%
	\tcolorbox[%
		baseboite,colframe=MediumVioletRed,%
		overlay unbroken and first={%
			\TitreBoite{MediumVioletRed}{\faCalculator}{Calculatrice}{\theMaquetteCalculatrice}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
			\IfStrEq{\BoxModCalc}{}{}{\ModeleCoinDroit}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{coutil}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteOutil}}{}%
	\tcolorbox[%
		baseboite,colframe=DeepSkyBlue,%
		overlay unbroken and first={%
			\TitreBoite{DeepSkyBlue}{\faTools}{Outil}{\theMaquetteOutil}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{casavoir}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteAsavoir}}{}%
	\tcolorbox[%
		baseboite,colframe=Red,%
		overlay unbroken and first={%
			\TitreBoite{Red}{\\faHeart}{À savoir}{\theMaquetteAsavoir}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cbloctd}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteTD}}{}%
	\tcolorbox[%
		baseboite,colframe=LightSeaGreen,%
		overlay unbroken and first={%
			\TitreBoite{LightSeaGreen}{\faHourglassStart}{TD}{\theMaquetteTD}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cblocdm}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteAvousdejouer}}{}%
	\tcolorbox[%
		baseboite,colframe=LightSeaGreen,%
		overlay unbroken and first={%
			\TitreBoite{LightSeaGreen}{\faHourglassStart}{À vous de jouer}{\theMaquetteAvousdejouer}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{crappel}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteRappel}}{}%
	\tcolorbox[%
		baseboite,colframe=LightSalmon,%
		overlay unbroken and first={%
			\TitreBoite{LightSalmon}{\faHandPointUp[regular]}{Rappel}{\theMaquetteRappel}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cresol}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteResolution}}{}%
	\tcolorbox[%
		baseboite,colframe=LightSeaGreen,%
		overlay unbroken and first={%
			\TitreBoite{LightSeaGreen}{\faPuzzlePiece}{Résolution}{\theMaquetteResolution}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{cattention}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteAttention}}{}%
	\tcolorbox[%
		baseboite,colframe=Red,%
		overlay unbroken and first={%
			\TitreBoite{Red}{\faExclamationTriangle}{Attention}{\theMaquetteAttention}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\NewDocumentEnvironment{ccode}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteCode}}{}%
	\tcolorbox[%
		baseboite,colframe=Crimson,%
		overlay unbroken and first={%
			\TitreBoite{Crimson}{\faCode}{Code}{\theMaquetteCode}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

%python
\NewDocumentEnvironment{cpython}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquettePython}}{}%
	\tcolorbox[%
		baseboite,colframe=teal,%
		overlay unbroken and first={%
			\TitreBoite{teal}{\faPython}{Python}{\theMaquettePython}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

%demo
\NewDocumentEnvironment{cdemo}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteDemo}}{}%
	\tcolorbox[%
		baseboite,colframe=Violet,%
		overlay unbroken and first={%
			\TitreBoite{Violet}{\faEdit[regular]}{Démonstration}{\theMaquetteDemo}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
			\begin{tcbclipinterior}\node[font=\large\bfseries,text=Violet] at ($(interior.south east)+(-10pt,10pt)$){\CheckedBox};\end{tcbclipinterior}
		}%
	]%
}{\endtcolorbox}%

%loglogo
\NewDocumentEnvironment{clog}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteLog}}{}%
	\tcolorbox[%
		baseboite,colframe=CornflowerBlue,%
		overlay unbroken and first={%
			\TitreBoite{CornflowerBlue}{\faDev}{Logiciel}{\theMaquetteLog}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
			\IfStrEq{\BoxLogo}{}{}{\LogoCoinDroit}%
		}%
	]%
}{\endtcolorbox}%

%algo
\NewDocumentEnvironment{calgo}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteAlgo}}{}%
	\tcolorbox[%
		baseboite,colframe=OrangeRed,%
		overlay unbroken and first={%
			\TitreBoite{OrangeRed}{\faFileCode}{Algorithme}{\theMaquetteAlgo}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
			\begin{tcbclipinterior}\node[opacity=0.15,rotate=-15] at ($(interior.south east)+(-8pt,12pt)$){\includegraphics[height=24pt]{algorithmvec}};\end{tcbclipinterior}
		}%
	]%
}{\endtcolorbox}%

%aide
\NewDocumentEnvironment{caide}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteAide}}{}%
	\tcolorbox[%
		baseboite,colframe=titrebleu,%
		overlay unbroken and first={%
			\TitreBoite{titrebleu}{\faBacon}{Niveaux de difficulté}{\theMaquetteAide}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
			\begin{tcbclipinterior}\node[opacity=0.33,rotate=45,scale=0.33,text=titrebleu!25!Black,font=\footnotesize\bfseries\sffamily] at ($(interior.south east)+(-6pt,6pt)$){\textcopyright{} Dairon11};\end{tcbclipinterior}
		}%
	]%
}{\endtcolorbox}%

%scratch
\definecolor{orangescratch}{HTML}{F8A31F}
\NewDocumentEnvironment{cscratch}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteScratch}}{}%
	\tcolorbox[%
	baseboite,colframe=orangescratch,%
	overlay unbroken and first={%
		\TitreBoite{orangescratch}{\includegraphics[height=1em]{scratch}}{Scratch}{\theMaquetteScratch}
		\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		\begin{tcbclipinterior}\node[opacity=0.33,rotate=45] at ($(interior.south east)+(-12pt,12pt)$){\includegraphics[height=12pt]{scratchban}};\end{tcbclipinterior}
	}%
	]%
}{\endtcolorbox}%

%réponse
\NewDocumentEnvironment{creponse}{ O{} }%
{%
	\useKVdefault[Boites]%
	\setKV[Boites]{#1}%
	\ifboolKV[Boites]{Compteur}{\stepcounter{MaquetteReponse}}{}%
	\tcolorbox[%
		baseboite,colframe=Thistle,%
		overlay unbroken and first={%
			\TitreBoite{Thistle}{\faIcon{pen-alt}}{Réponse}{\theMaquetteReponse}
			\IfStrEq{\BoxSubTitle}{}{}{\SousTitreBoite}%
		}%
	]%
}{\endtcolorbox}%

\else

\if@breakable
	\tcbuselibrary{breakable}
	\tcbset{cdefaut/.style={%
			fonttitle=\fontbox,%
			enhanced,breakable,center,boxrule=1.25pt,drop shadow=black!33!white,%
			sharp corners=uphill,arc=12pt,before skip=12pt,after skip=12pt,%
			left=5pt,leftupper=5pt,top=1mm,bottom=1mm,%
			before upper=\leavevmode
		}
	}
\else
	\tcbset{cdefaut/.style={%
			fonttitle=\fontbox,%
			enhanced,center,boxrule=1.25pt,drop shadow=black!33!white,%
			sharp corners=uphill,arc=12pt,before skip=12pt,after skip=12pt,%
			left=5pt,leftupper=5pt,top=1mm,bottom=1mm,%
			before upper=\leavevmode
		}
	}
\fi

\NewDocumentCommand\cpnewbox{ m m m m O{#4} !O{} }{%nom + titre + icone + bordure/titre/fondtitre + couleur fond + options
	\DeclareTColorBox{#1}{ O{} }{%
		cdefaut,%
		colframe=#4,coltitle=#4!25!Black,colbacktitle=#4!35,colback=#5!10,%
		title={#3\:\:\titrebox{#2##1}},%
		#6
	}%
}

\cpnewbox{cdefi}{Définition}{\faIcon[regular]{comment-dots}}{ForestGreen}
\cpnewbox{chumour}{Humour}{\faIcon[regular]{laugh-wink}}{Yellow}
\cpnewbox{cprop}{Propriété}{\faCog}{Salmon}
\cpnewbox{ccscq}{Conséquence}{\faArrowAltCircleRight[regular]}{Salmon}
\cpnewbox{cthm}{Théorème}{\faBullhorn}{FireBrick}
\cpnewbox{clog}{Logiciel}{\faDev}{CornflowerBlue}[white]
\cpnewbox{chistoire}{Point histoire}{\faUniversity}{Chocolate}[white]
\cpnewbox{crmq}{Remarque}{\faHandPointRight[regular]}{MidnightBlue}[white]
\cpnewbox{cexercice}{Exercice}{\faHubspot}{MidnightBlue}
\cpnewbox{cexemple}{Exemple}{\faHubspot}{MediumTurquoise}
\cpnewbox{cvoc}{Vocabulaire}{\faList*[regular]}{YellowGreen}
\cpnewbox{cnota}{Notation}{\faList*}{YellowGreen}
\cpnewbox{ccadre}{Cadre}{\faInfoCircle}{Peru}
\cpnewbox{cidee}{Idée}{\faInfo}{LightBlue}
\cpnewbox{cintro}{Intro}{\faMarker}{LightSalmon}
\cpnewbox{cillustr}{Illustration}{\faChartLine}{Crimson}[White]
\cpnewbox{cvideo}{}{\faIcon[regular]{file-video}}{teal}[White]
\cpnewbox{cbilan}{Bilan}{\faForward}{Purple}
\cpnewbox{cmethode}{Méthode}{\faTasks}{Coral}
\cpnewbox{ctuto}{Tuto}{\faTerminal}{Coral}[White]
\cpnewbox{cmanip}{Manipulation}{\faCodeBranch}{DarkCyan}[White]
\cpnewbox{ccalco}{Calculatrice}{\faCalculator}{MediumVioletRed}[White]
\cpnewbox{coutil}{Outil}{\faTools}{DeepSkyBlue}[White]
\cpnewbox{casavoir}{À savoir}{\faHeart}{Red}
\cpnewbox{cbloctd}{TD}{\faHourglassStart}{LightSeaGreen}[White]
\cpnewbox{cblocdm}{À vous de jouer}{\faHourglassStart}{LightSeaGreen}[White]
\cpnewbox{crappel}{Rappel}{\faHandPointUp[regular]}{LightSalmon}
\cpnewbox{cresol}{Résolution}{\faPuzzlePiece}{LightSeaGreen}[White]
\cpnewbox{cattention}{Attention}{\faExclamationTriangle}{Red}
\cpnewbox{ccode}{Code}{\faCode}{Crimson}[White]
\cpnewbox{cpython}{Python}{\faPython}{SeaGreen}[White]

%outil
\newtcolorbox{coutilcalc}[1][]{%
	cdefaut,%
	colframe=DeepSkyBlue,coltitle=black,colbacktitle=DeepSkyBlue!35,colback=White,
	title=\textcolor{DeepSkyBlue!25!Black}{\faFileVideo[regular]\:\:\titrebox{Tuto#1 Vidéo}}
}

%loglogo
\newtcolorbox{cloglogo}[2][]{%
	cdefaut,%
	colframe=CornflowerBlue,coltitle=black,colbacktitle=CornflowerBlue!35,colback=white,
	title=\textcolor{CornflowerBlue!25!Black}{\faDev\:\:\titrebox{Logiciel#1}},
	overlay={\begin{tcbclipinterior}
			\node[opacity=0.33,rotate=-45] at ($(interior.south east)+(-10pt,10pt)$){\includegraphics[height=24pt]{#2}};
	\end{tcbclipinterior}}
}

%demo
\newtcolorbox{cdemo}[1][]{%
	cdefaut,%
	colframe=Violet,coltitle=black,colbacktitle=Violet!35,colback=Violet!15,
	title=\textcolor{Violet!25!Black}{\faEdit[regular]\:\:\titrebox{Démonstration#1}},
	overlay={\begin{tcbclipinterior}%
			\node[] at ($(interior.south east)+(-10pt,10pt)$){\large\textcolor{Violet}{\textbf{\CheckedBox}}};%
	\end{tcbclipinterior}}
}

%demoblanc
\newtcolorbox{cdemoblanc}[1][]{%
	cdefaut,%
	colframe=Violet,coltitle=black,colbacktitle=Violet!35,colback=White,
	title=\textcolor{Violet!25!Black}{\faEdit[regular]\:\:\titrebox{Démonstration#1}},
	overlay={\begin{tcbclipinterior}%
			\node[] at ($(interior.south east)+(-10pt,10pt)$){\large\textcolor{Violet}{\textbf{\CheckedBox}}};%
	\end{tcbclipinterior}}
}

%algo
\newtcolorbox{calgo}[1][]{%
	cdefaut,%
	colframe=OrangeRed,coltitle=black,colbacktitle=OrangeRed!35,colback=White,
	title=\textcolor{OrangeRed!25!Black}{\faFileCode\:\:\titrebox{Algorithme#1}},
	overlay={\begin{tcbclipinterior}%
			\node[opacity=0.15,rotate=-15] at ($(interior.south east)+(-8pt,12pt)$){\includegraphics[height=24pt]{algorithmvec}};%
	\end{tcbclipinterior}}
}


%aide
\newtcolorbox{caide}{%
	cdefaut,%
	colframe=titrebleu!35,coltitle=titrebleu!50!Black,colbacktitle=titrebleu!15,colback=White,
	title=\textcolor{titrebleu!25!Black}{\faBacon\:\:\titrebox{Niveaux de difficulté}},
	overlay={\begin{tcbclipinterior}%
			\node[opacity=0.33,rotate=45,scale=0.33] at ($(interior.south east)+(-6pt,6pt)$){\textcolor{titrebleu!50!Black}{\footnotesize \bfseries \sffamily \textcopyright{} Dairon11}};%
	\end{tcbclipinterior}}
}

\newtcolorbox{ccalcologo}[2][]{%
	cdefaut,%
	colframe=MediumVioletRed,coltitle=black,colbacktitle=MediumVioletRed!35,colback=White,
	title=\textcolor{MediumVioletRed!25!Black}{\faCalculator\:\:\titrebox{Calculatrice#1}},
	overlay={\begin{tcbclipinterior}%
			\node[opacity=0.33,rotate=-45] at ($(interior.south east)+(-10pt,10pt)$){\includegraphics[height=48pt]{#2}};%
	\end{tcbclipinterior}}
}

\definecolor{orangescratch}{HTML}{F8A31F}
\newtcolorbox{cscratch}[1][]{%
	cdefaut,%
	colframe=orangescratch,coltitle=black,colbacktitle=orangescratch!35,colback=White,
	title=\textcolor{orange!25!Black}{\includegraphics[height=1em]{scratch}\:\:\titrebox{Scratch#1}},
	overlay={\begin{tcbclipinterior}%
			\node[opacity=0.33,rotate=45] at ($(interior.south east)+(-12pt,12pt)$){\includegraphics[height=12pt]{scratchban}};%
	\end{tcbclipinterior}}
}

%reponse
\newtcolorbox{creponse}[1][]{%
	cdefaut,%
	colframe=Thistle,coltitle=black,colbacktitle=Thistle!35,colback=White,
	before upper = \vspace{-0.05cm},
	title=\textcolor{Thistle!25!Black}{\faIcon{pen-alt}\:\:\titrebox{Réponse#1}}
}

\fi

%==========================calculatrice CASIO
\ifluatex
	\newcommand{\itemnqd}[1]{%
		\setlength{\fboxsep}{1pt}%
		{\footnotesize \colorbox{black}{\fontcalcqd\bfseries\white #1}}}
	\newcommand{\itembqd}[1]{%
		\setlength{\fboxsep}{1pt}%
		{\footnotesize \fbox{\fontcalcqd\bfseries #1}}}
	\newcommand{\itemntc}[1]{%
		\setlength{\fboxsep}{1pt}%
		{\footnotesize \colorbox{black}{\fontcalctc\bfseries\white #1}}}
	\newcommand{\itembtc}[1]{%
		\setlength{\fboxsep}{1pt}%
		{\footnotesize \fbox{\fontcalctc\bfseries #1}}}
\else
	\newcommand{\itemnqd}[1]{%
		\setlength{\fboxsep}{1pt}%
		{\footnotesize \colorbox{black}{\fontfamily{pcr}\selectfont\bfseries\white #1}}}
	\newcommand{\itembqd}[1]{%
		\setlength{\fboxsep}{1pt}%
		{\footnotesize \fbox{\texttt{#1}}}}
\fi

\newlength\largmenutc
\settowidth{\largmenutc}{\policecasiotc XXXX}
\addtolength{\largmenutc}{2pt}
\newlength\largitemtc
\settowidth{\largitemtc}{\ttfamily\textbf{XXXXXXXXXXXXXXXXXXX}}

\tcbset{casiotc/.style={%
		enhanced,%
		fontupper=\policecasiotc,%
		nobeforeafter,%
		box align=base,%
		boxsep=1pt,%
		boxrule=0.75pt,%
		boxsep=1pt,%
		left=0pt,%
		right=0pt,%
		top=0pt,%
		bottom=0pt,%
		tcbox width=forced center,%
		no borderline
	}
}
\tcbset{casiotcmenunoir/.style={%
		width=\largmenutc,%
		colframe=black,%
		colback=black,%
		colupper=white,%
		sharp corners,%
		rounded corners=southeast,%
		arc=3pt,%
		arc is angular,%
		add to width=1pt
	}
}
\tcbset{casiotcmenublanc/.style={%
		enhanced,%
		frame hidden,%
		width=\largmenutc,%
		colframe=black,%
		colback=white,%
		colupper=black,%
		sharp corners,%
		add to width=1pt,
		borderline north={0.75pt}{0pt}{black},
		borderline west={0.75pt}{0pt}{black}
	}
}
\tcbset{casiotcitemnoir/.style={%
		width=\largmenutc,%
		colframe=black,%
		colback=black,%
		colupper=white,%
		sharp corners,%
		add to width=1pt
	}
}
\tcbset{casiotcitemsel/.style={%
		width=\largitemtc,%
		tcbox width=auto,%
		sharp corners,%
		colframe=black,%
		colback=black,%
		colupper=white,%
	}
}

\newlength\largmenuqd
\settowidth{\largmenuqd}{\policecasioqd XXXXX}
\tcbset{casioqd/.style={%
		fontupper=\policecasioqd,%
		nobeforeafter,%
		box align=base,%
		boxsep=1pt,%
		boxrule=0.75pt,%
		boxsep=1pt,%
		left=0pt,%
		right=0pt,%
		top=0pt,%
		bottom=0pt,%
		tcbox width=forced center
	}
}
\tcbset{casioqdmenunoir/.style={%
		enhanced,%
		width=\largmenuqd,%
		colframe=black,%
		colback=black,%
		colupper=white,%
		arc=1pt,%
		add to width=2pt
	}
}
\tcbset{casioqdmenublanc/.style={%
		width=\largmenuqd,%
		colframe=black,%
		colback=white,%
		colupper=black,%
		rounded corners,%
		arc=1pt,%
		add to width=2pt
	}
}
\tcbset{casioqditemnoir/.style={%
		width=\largmenuqd,%
		colframe=black,%
		colback=black,%
		colupper=white,%
		sharp corners,%
		add to width=2pt
	}
}

\newcommand\mencastcn[1]{\tcbox[casiotc,casiotcmenunoir]{#1}}
\newcommand\mencastcb[1]{\tcbox[casiotc,casiotcmenublanc]{#1}}
\newcommand\itcastcn[1]{\tcbox[casiotc,casiotcitemnoir]{#1}}
\newcommand\itcastcsel[1]{\tcbox[tcbox width=minimum center,casiotc,casiotcitemsel]{#1}}

\newcommand\mencasqdn[2][white]{\tcbox[casioqd,casioqdmenunoir,overlay={\path[fill=#1]($(frame.south east) + (0.1pt,-0.1pt)$) -- ++ (0pt,3.2pt)  -- ++ (-3.2pt,-3.2pt) -- cycle;}]{#2}}
\newcommand\mencasqdb[1]{\tcbox[casioqd,casioqdmenublanc]{#1}}
\newcommand\itcasqdn[1]{\tcbox[casioqd,casioqditemnoir]{#1}}
\newcommand\itcasqdsel[1]{\tcbox[casioqd,casiotcitemsel]{#1}}

%===========================calculatrice NWKS
\tcbset{vignettemenunwks/.style={%
		size=small,%
		left=2pt,right=2pt,%
		fontupper={\vphantom{pf}\scriptsize\fontnwks},%
		nobeforeafter,%
		box align=base,%
		boxsep=0pt,%
		sharp corners=all}
}

\newcommand\menunwks[1]{\tcbox[vignettemenunwks,colframe=gray,colupper=white,colback=gray]{\scalebox{0.9}[1]{#1}}}
\newcommand\menunwksg[1]{\tcbox[vignettemenunwks,colframe=lightgray!50,colupper=black,colback=lightgray!50]{\scalebox{0.9}[1]{#1}}}
\newcommand\menunwksb[1]{\tcbox[vignettemenunwks,colframe=lightgray,colupper=gray,colback=white]{\scalebox{0.9}[1]{#1}}}
\newcommand\nwkstri{\textcolor{orange}{$\blacktriangleright$}}

%==========================calculatrice TEXAS
\newcommand\menuselecti[1]{\tcbox[size=tight,fontupper=\ttfamily\bfseries\footnotesize,colback=black,colupper=white,nobeforeafter,left=0pt,right=0pt,top=0pt,bottom=0pt,box align=base,]{\scalebox{0.85}[1.15]{#1}}}

\newcommand\tpp{\scalebox{0.66}[1]{\dots}}

\newcommand\ongletselecti[1]{\tcbox[size=tight,fontupper=\ttfamily\bfseries\small,colback=black,colframe=black,colupper=white,nobeforeafter,left=0pt,right=0pt,top=0pt,bottom=0pt,box align=base]{\vphantom{[A]/Fiy}#1}}

\newcommand\itemselecti[2]{\ongletselecti{\NoAutoSpacing\vphantom{[A]/Fiy}#1}\tcbox[size=tight,fontupper=\ttfamily\bfseries\small,colback=white,colupper=black,nobeforeafter,left=1pt,right=0pt,top=0pt,bottom=0pt,box align=base,colframe=black]{\vphantom{[A]/Fiy}#2}}

%===============================fake's RS ;-)
\usetikzlibrary{shapes.geometric}

\tcbset{fakefb/.style={%
		enhanced,center,boxrule=1pt,rounded corners=all,arc=4pt,before skip=12pt,after skip=12pt,%
		colframe=gray,colback=white,colbacktitle=white,coltitle=black,%
		titlerule=0.4pt,titlerule style=lightgray,%
		left=5pt,top=2pt,bottom=2pt,right=5pt,middle=2pt
	}
}

\tcbset{faketw/.style={%
		enhanced,center,boxrule=1pt,rounded corners=all,arc=4pt,before skip=12pt,after skip=12pt,%
		colframe=gray,colback=white,%
		left=5pt,top=2pt,bottom=2pt,right=5pt,middle=2pt
	}
}

\newtcolorbox{fakeFB}[2][\linewidth]{width=#1,fakefb,title={#2}}
\setKVdefault[fakeFB]{img=avatar,nom={C. Pierquet},temps={37 min}}
\setKVdefault[fakeFBbottom]{likes=15,comm=4,partages=5}

\newtcolorbox{fakeTW}[1][\linewidth]{width=#1,faketw}
\setKVdefault[fakeTW]{img=avatar,nom={C. Pierquet},pseudo={cpierquet},temps={14 min}}


\newcommand\fakefbtitre[1][]{%
	\restoreKV[fakeFB]%
	\setKV[fakeFB]{#1}
	\begin{tabularx}{\linewidth}{@{}c@{}Xc}
		\multirow{2}{*}{\includegraphics[height=20pt]{\useKV[fakeFB]{img}}} & ~~\textsf{\small\useKV[fakeFB]{nom}} & \multirow{2}{*}{\LARGE $\cdot\!\cdot\!\cdot$} \\[-4pt]
		& ~~\textcolor{gray}{\textsf{\scriptsize \useKV[fakeFB]{temps}}} & \\
	\end{tabularx}
}

\newcommand\faketwtitre[1][]{%
	\restoreKV[fakeTW]%
	\setKV[fakeTW]{#1}%
	\begin{tabularx}{\linewidth}{@{}c@{}Xc}
		\raisebox{-0.33\height}{\includegraphics[height=20pt]{\useKV[fakeTW]{img}}} & ~~\textsf{\small\useKV[fakeTW]{nom}} \textcolor{gray}{\small \textsf{~@\useKV[fakeTW]{pseudo}}~$\mathsf{\cdot}$~\textsf{\useKV[fakeTW]{temps}}} & {\LARGE $\cdot\!\cdot\!\cdot$} \\
	\end{tabularx}%
}

\newcommand\fakefbcommandes[1][]{%
	\restoreKV[fakeFBbottom]%
	\setKV[fakeFBbottom]{#1}%
	\begin{tabularx}{\linewidth}{@{}X@{}}
		$\vcenter{\hbox{\includegraphics[height=6pt]{fblike}}}$ \textcolor{gray}{\textsf{\scriptsize\useKV[fakeFBbottom]{likes}}} \hfill \textcolor{gray}{\textsf{\scriptsize\useKV[fakeFBbottom]{comm} commentaires \useKV[fakeFBbottom]{partages} partages}} \\ \arrayrulecolor{lightgray}\hline
		{\tiny \faThumbsUp}~\textsf{\scriptsize\textbf{J’aime}} \hfill {\tiny\faComment*[regular]}~\textsf{\scriptsize\textbf{Commenter}} \hfill {\tiny\faShareSquare}~\textsf{\scriptsize\textbf{Partager}} \\
	\end{tabularx}
}

\newcommand\faketwcommandes{%
	\begin{tabularx}{\linewidth}{@{}Y@{}Y@{}Y@{}Y@{}}
		{\footnotesize\faComment[regular]} & {\footnotesize\faRetweet} & {\footnotesize\faHeart} & {\footnotesize\faShareSquare} \\
	\end{tabularx}
}

%==============================commandes tikz
\newcommand\papierseyes{\@ifstar{\papierseyes@star}{\papierseyes@nostar}}
\newcommand\papierseyes@nostar[2]{%
	\begin{center}
		\begin{tikzpicture}[x=0.8cm,y=0.8cm]
			\draw[xstep=1,ystep=0.2,line width=0.2pt,color=cyan!50] (0,0) grid (#1,#2);
			\draw[xstep=1,ystep=1,line width=0.4pt,color=cyan] (0,0) grid (#1,#2);
		\end{tikzpicture}
	\end{center}%
	}
\newcommand\papierseyes@star[2]{%
	\begin{tikzpicture}[x=0.8cm,y=0.8cm]
		\draw[xstep=1,ystep=0.2,line width=0.2pt,color=cyan!50] (0,0) grid (#1,#2);
		\draw[xstep=1,ystep=1,line width=0.4pt,color=cyan] (0,0) grid (#1,#2);
	\end{tikzpicture}%
}

\newcommand\newpapierseyes[2]{%
	\begin{tikzpicture}[x=0.8cm,y=0.8cm]
		\draw[xstep=1,ystep=0.2,color=LightSteelBlue] (0,0) grid ({#1-3},#2);
		\draw[xstep=1,ystep=1,color=Plum] (0,0) grid ({#1-3},#2);
		\foreach \LL in {0,0.2,...,#2} {\draw[color=LightSteelBlue] (-3,\LL)--(0,\LL) ; }
		\draw[color=Plum] (-3,0)--(-3,#2) ;
		\foreach \L in {0,1,...,#2} {\draw[color=Plum] (-3,\L)--(0,\L) ; }
		\draw[thick,red!75] (0,0)--(0,#2) ;
	\end{tikzpicture}%
}

\tikzset{cross/.pic={\draw[rotate=45] (-#1,0) -- (#1,0);\draw[rotate=45] (0,-#1) -- (0, #1);}
}

\tikzset{pics/dotcross/.style args={#1}{
		code={
			\draw[line width={0.5*#1},rotate=45] (-#1,0) -- (#1,0);
			\draw[line width={0.5*#1},rotate=45] (0,-#1) -- (0, #1);
		}
	},
	pics/dotcross/.default=4pt
}

\tikzset{hachures/.style args={line width=#1pt,angle=#2,distance=#3}{
		pattern={Lines[line width=#1pt,angle=#2,distance=#3]}},
		hachures/.default={line width=1pt,angle=45,distance=5pt}
}

\tikzset{arrowinside/.style 2 args={postaction={decorate},decoration={markings,mark=at position #1 with {\arrow[scale=#2]{>}}}}}

\tikzset{%
	Ox/.store in=\axexOx,Ox/.default=0,Ox=0,%essai
	Oy/.store in=\axeyOy,Oy/.default=0,Oy=0,%essai
	xmin/.store in=\xmin,xmin/.default=-5,xmin=-5,
	xmax/.store in=\xmax,xmax/.default=5,xmax=5,
	ymin/.store in=\ymin,ymin/.default=-5,ymin=-5,
	ymax/.store in=\ymax,ymax/.default=5,ymax=5,
	xgrille/.store in=\xgrille,xgrille/.default=1,xgrille=1,
	xgrilles/.store in=\xgrilles,xgrilles/.default=0.5,xgrilles=0.5,
	ygrille/.store in=\ygrille,ygrille/.default=1,ygrille=1,
	ygrilles/.store in=\ygrilles,ygrilles/.default=0.5,ygrilles=0.5,
	xunit/.store in=\xunit,xunit/.default=1,xunit=1,
	yunit/.store in=\yunit,yunit/.default=1,yunit=1
}

\newcommand\tunits[2]{%
	\def\xunit{#1}\def\yunit{#2}
}

\newcommand\tdefgrille[8]{%
	\def\xmin{#1}\def\xmax{#2}\def\ymin{#5}\def\ymax{#6}
	\def\xgrille{#3}\def\xgrilles{#4}\def\ygrille{#7}\def\ygrilles{#8}
}

\newcommand\tgrilles[1][ultra thin,lightgray]{%
	\draw[xstep=\xgrilles,ystep=\ygrilles,#1] (\xmin,\ymin) grid (\xmax,\ymax);
}
\newcommand\tgrillep[1][thin,gray]{%
	\draw[xstep=\xgrille,ystep=\ygrille,#1] (\xmin,\ymin) grid (\xmax,\ymax);
}

\define@key{tikzaxex}{Ox}{\def\axex@Ox{#1}}
\define@key{tikzaxex}{width}{\def\axex@width{#1}}
\define@key{tikzaxex}{font}{\def\axex@font{#1}}
\define@key{tikzaxex}{size}{\def\axex@size{#1}}
\define@key{tikzaxex}{tickwidth}{\def\axex@tickwidth{#1}}
\define@key{tikzaxey}{Oy}{\def\axey@Oy{#1}}
\define@key{tikzaxey}{width}{\def\axey@width{#1}}
\define@key{tikzaxey}{size}{\def\axey@size{#1}}
\define@key{tikzaxey}{tickwidth}{\def\axey@tickwidth{#1}}
\define@key{tikzaxes}{width}{\def\axes@width{#1}}
\define@key{tikzaxey}{font}{\def\axey@font{#1}}
\define@key{tikzaxes}{labelx}{\def\axes@labelx{#1}}
\define@key{tikzaxes}{labely}{\def\axes@labely{#1}}
\define@key{tikzaxes}{poslabelx}{\def\axes@poslabelx{#1}}
\define@key{tikzaxes}{poslabely}{\def\axes@poslabely{#1}}
\define@key{tikzaxes}{echellefleche}{\def\axes@echellefleche{#1}}
\define@key{tikzaxes}{typefleche}{\def\axes@typefleche{#1}}
\setkeys{tikzaxex}{Ox=0,width=1.25pt,size=\normalsize,tickwidth=4pt,font=\normalfont}
\setkeys{tikzaxey}{Oy=0,width=1.25pt,size=\normalsize,tickwidth=4pt,font=\normalfont}
\setkeys{tikzaxes}{width=1.25pt,labelx=,labely=,poslabelx=right,poslabely=above,echellefleche=1,typefleche=>}

\newcommand\axextikz{\@ifstar{\axextikz@star}{\axextikz@nostar}}
\newcommand\axextikz@nostar[2][]{%
	\setkeys{tikzaxex}{#1}% on paramètres les nouvelles clés
	\foreach \x in {#2}{%
		\draw[line width=\axex@width] ({\x-\axex@Ox},{\axex@tickwidth}) -- ({\x-\axex@Ox},{-\axex@tickwidth}) node[below,font=\axex@font] {\axex@size \num[text-family-to-math=true,text-series-to-math=true]{\x}};}
}
\newcommand\axextikz@star[2][]{%
	\setkeys{tikzaxex}{#1}% on paramètres les nouvelles clés
	\foreach \x in {#2}{%
		\draw[line width=\axex@width] ({\x-\axex@Ox},{\axex@tickwidth}) -- ({\x-\axex@Ox},{-\axex@tickwidth});}
}
%à garder si ça buggue... node[below] {\axex@size \num{\x}}

\newcommand\axeytikz{\@ifstar{\axeytikz@star}{\axeytikz@nostar}}
\newcommand\axeytikz@nostar[2][]{%
	\setkeys{tikzaxey}{#1}% on paramètres les nouvelles clés
	\foreach \y in {#2}{%
		\draw[line width=\axey@width] ({\axey@tickwidth},{\y-\axey@Oy}) -- ({-\axey@tickwidth},{\y-\axey@Oy}) node[left,font=\axey@font] {\axey@size \num[text-family-to-math=true,text-series-to-math=true]{\y}};}
}
\newcommand\axeytikz@star[2][]{%
	\setkeys{tikzaxey}{#1}% on paramètres les nouvelles clés
	\foreach \y in {#2}{%
		\draw[line width=\axey@width] ({\axey@tickwidth},{\y-\axey@Oy}) -- ({-\axey@tickwidth},{\y-\axey@Oy});}
}

\newcommand\axestikz{\@ifstar{\axestikz@star}{\axestikz@nostar}}

\newcommand\axestikz@nostar[1][]{%
	\setkeys{tikzaxes}{#1}% on paramètres les nouvelles clés
	{\draw[line width=\axes@width,-{\axes@typefleche[scale=\axes@echellefleche]}] (\xmin,0) -- (\xmax,0) node[\axes@poslabelx] {\axes@labelx} ;
	\draw[line width=\axes@width,-{\axes@typefleche[scale=\axes@echellefleche]}] (0,\ymin) -- (0,\ymax) node[\axes@poslabely] {\axes@labely} ;}
}

\newcommand\axestikz@star[1][]{%
	\setkeys{tikzaxes}{#1}% on paramètres les nouvelles clés
	{\draw[line width=\axes@width,-{\axes@typefleche[scale=\axes@echellefleche]}] (\xmin,0) -- (\xmax,0) ;
	\draw[line width=\axes@width,-{\axes@typefleche[scale=\axes@echellefleche]}] (0,\ymin) -- (0,\ymax);}
}

\newcommand\tcoord[3][line width=1pt,dashed,ForestGreen,arrowinside={0.5}{1}]{%
	{\draw[#1] (#2,0) -- (#2,#3) ;
	\draw[#1] (#2,#3) -- (0,#3) ;}
}

\def\pgfpointnormalised#1{%
	\pgf@process{#1}%
	\pgfmathatantwo{\the\pgf@y}{\the\pgf@x}%
	\let\pgf@tmp=\pgfmathresult%
	\pgfmathcos@{\pgf@tmp}\pgf@x=\pgfmathresult pt\relax%
	\pgfmathsin@{\pgf@tmp}\pgf@y=\pgfmathresult pt\relax%
}

%====================================Karnaugh
\usepackage{xargs}
\usetikzlibrary{patterns,arrows,decorations.pathreplacing}
\newcommandx\KarnaughD[2][1=a,2=b]{%
	\draw[thick] (0,0) rectangle (2,2);
	\draw[thick] (0,1)--(2,1);
	\draw[thick] (1,0)--(1,2);
	\node at (-0.33,0.5) {$\strut\mathtt{\overline{#1}}$};
	\node at (-0.33,1.5) {$\strut\mathtt{#1}$};
	\node at (0.5,2.33) {$\strut\mathtt{#2}$};
	\node at (1.5,2.33) {$\strut\mathtt{\overline{#2}}$};
}

\defKV[tblkgh]{%
	Echelle=\def\KGHTechelle{#1},%
	Variables=\def\KGHTvariables{#1}
}

\setKVdefault[tblkgh]{%
	Echelle=1,%
	Variables=a§b§c
}

\NewDocumentEnvironment{TableKarnaugh}{ O{} D<>{} }%
{%
	\useKVdefault[tblkgh]%
	\setKV[tblkgh]{#1}%
	\setsepchar{§}%
	\readlist*\ListeVariablesKGH\KGHTvariables%
	\begin{tikzpicture}[scale=\KGHTechelle,line join=miter,#2]
		\coordinate (A00) at (0,0) ; \coordinate (A10) at (1,0) ;
		\coordinate (A20) at (2,0) ; \coordinate (A30) at (3,0) ;
		\coordinate (A40) at (4,0) ; \coordinate (A01) at (0,1) ;
		\coordinate (A11) at (1,1) ; \coordinate (A21) at (2,1) ;
		\coordinate (A31) at (3,1) ; \coordinate (A41) at (4,1) ;
		\coordinate (A02) at (0,2) ; \coordinate (A12) at (1,2) ;
		\coordinate (A22) at (2,2) ; \coordinate (A32) at (3,2) ;
		\coordinate (A42) at (4,2) ;
		\draw[thick,decorate,decoration={brace,amplitude=5pt}](0,2.05)--(2,2.05) ;
		\draw[thick,decorate,decoration={brace,amplitude=5pt}](2,2.05)--(4,2.05) ;
		\draw[thick,decorate,decoration={brace,amplitude=5pt,mirror}](1,-0.05)--(3,-0.05) ;
		\node[inner sep=1pt] at (-0.33,0.5) {$\strut\mathtt{\overline{\ListeVariablesKGH[1]}}$};
		\node[inner sep=1pt] at (-0.33,1.5) {$\strut\mathtt{\ListeVariablesKGH[1]}$};
		\node[inner sep=1pt] at (1,2.5) {$\strut\mathtt{\ListeVariablesKGH[2]}$};
		\node[inner sep=1pt] at (3,2.5) {$\strut\mathtt{\overline{\ListeVariablesKGH[2]}}$};
		\node[inner sep=1pt] at (0.5,-0.54) {$\strut\mathtt{\ListeVariablesKGH[3]}$};
		\node[inner sep=1pt] at (3.5,-0.54) {$\strut\mathtt{\ListeVariablesKGH[3]}$};
		\node[inner sep=1pt] at (2,-0.54) {$\strut\mathtt{\overline{\ListeVariablesKGH[3]}}$};
		\draw[thick] (0,0) grid (4,2) ; \draw[thick] (0,0) rectangle (4,2) ;
	}%
	{%
	\end{tikzpicture}
}%

\defKV[blockarnaugh]{%
	Decalage=\def\KGHdecalage{#1},%
	Couleur=\def\KGHcouleur{#1},%
	Type=\def\KGHtype{#1}
}

\setKVdefault[blockarnaugh]{%
	Epaisseur=2pt,%
	Couleur=Red,%
	Type=Centre
}

\newcommand\KarnaughBlocCoul[2][lightgray]{%
	\setsepchar[.]{§./}%
	\readlist*\KGHListeRect{#2}%
	\xintFor* ##1 in {\xintSeq{1}{\KGHListeRectlen}}\do{%
		\draw[thick,fill=#1] (A\KGHListeRect[##1,1]) rectangle (A\KGHListeRect[##1,2]) ;
		\draw[thick] (A\KGHListeRect[##1,1]) grid (A\KGHListeRect[##1,2]) ;
	}%
}

\newcommand\KarnaughBlocRegroup[3][]{%
	\useKVdefault[blockarnaugh]%
	\setKV[blockarnaugh]{#1}%
	\IfStrEq{\KGHtype}{Centre}%
		{\draw[rounded corners,line width=1.25pt,color=\KGHcouleur] ($(A#2)+(-\KGHdecalage,-\KGHdecalage)$) rectangle ($(A#3)+(\KGHdecalage,\KGHdecalage)$);}%
		{}%
	\IfStrEq{\KGHtype}{Gauche}%#2=BG #3=HD
		{%
			\StrChar{#2}{1}[\KGHia]%
			\StrChar{#2}{2}[\KGHja]%
			\StrChar{#3}{1}[\KGHib]%
			\StrChar{#3}{2}[\KGHjb]%
			\draw[rounded corners,line width=1.25pt,color=\KGHcouleur]%
			($(A#2)+(-\KGHdecalage,-\KGHdecalage)$) -- ($(A\KGHib\KGHja)+(\KGHdecalage,-\KGHdecalage)$)%
			-- ($(A#3)+(\KGHdecalage,\KGHdecalage)$) -- ($(A\KGHia\KGHjb)+(-\KGHdecalage,\KGHdecalage)$);%
		}%
		{}%
	\IfStrEq{\KGHtype}{Droite}%#2=BD #3=HG
		{%
			\StrChar{#2}{1}[\KGHia]%
			\StrChar{#2}{2}[\KGHja]%
			\StrChar{#3}{1}[\KGHib]%
			\StrChar{#3}{2}[\KGHjb]%
			\draw[rounded corners,line width=1.25pt,color=\KGHcouleur]%
			($(A#2)+(\KGHdecalage,-\KGHdecalage)$) -- ($(A\KGHib\KGHja)+(-\KGHdecalage,-\KGHdecalage)$)%
			-- ($(A#3)+(-\KGHdecalage,\KGHdecalage)$) -- ($(A\KGHia\KGHjb)+(\KGHdecalage,\KGHdecalage)$);%
		}%
		{}%
}

\newcommand\KarnaughBlocMilieu[6]{%
	\draw[rounded corners,line width=1.25pt,color=#5] ($(A#1#2)+(#6,#6)$) rectangle ($(A#3#4)-(#6,#6)$);
}
\newcommand\KarnaughBlocGauche[6]{%
	\draw[rounded corners,line width=1.25pt,color=#5] ($(A#1#2)+(#6,#6)$) -- ($(A#3#2)+(-#6,#6)$) -- ($(A#3#4)+(-#6,-#6)$) -- ($(A#1#4)+(#6,-#6)$);
}
\newcommand\KarnaughBlocDroit[6]{%
	\draw[rounded corners,line width=1.25pt,color=#5] ($(A#1#2)+(-#6,#6)$) -- ($(A#3#2)+(#6,#6)$) -- ($(A#3#4)+(#6,-#6)$) -- ($(A#1#4)+(-#6,-#6)$);
}
\newcommandx\KarnaughDefT[3][1=a,2=b,3=c]{%
	%NŒUDS
	\coordinate (A00) at (0,0) ;
	\coordinate (A10) at (1,0) ;
	\coordinate (A20) at (2,0) ;
	\coordinate (A30) at (3,0) ;
	\coordinate (A40) at (4,0) ;
	\coordinate (A01) at (0,1) ;
	\coordinate (A11) at (1,1) ;
	\coordinate (A21) at (2,1) ;
	\coordinate (A31) at (3,1) ;
	\coordinate (A41) at (4,1) ;
	\coordinate (A02) at (0,2) ;
	\coordinate (A12) at (1,2) ;
	\coordinate (A22) at (2,2) ;
	\coordinate (A32) at (3,2) ;
	\coordinate (A42) at (4,2) ;
	%rectangles
	\draw[thick] (0,0) rectangle (4,2);
	\draw[thick] (0,1)--(4,1);
	\draw[thick] (1,0)--(1,2);
	\draw[thick] (2,0)--(2,2);
	\draw[thick] (3,0)--(3,2);
	\draw[thick,decorate,decoration={brace,amplitude=5pt}](0,2.05)--(2,2.05) ;
	\draw[thick,decorate,decoration={brace,amplitude=5pt}](2,2.05)--(4,2.05) ;
	\draw[thick,decorate,decoration={brace,amplitude=5pt,mirror}](1,-0.05)--(3,-0.05) ;
	\node at (-0.33,0.5) {$\strut\mathtt{\overline{#1}}$};
	\node at (-0.33,1.5) {$\strut\mathtt{#1}$};
	\node at (1,2.5) {$\strut\mathtt{#2}$};
	\node at (3,2.5) {$\strut\mathtt{\overline{#2}}$};
	\node at (0.5,-0.54) {$\strut\mathtt{#3}$};
	\node at (3.5,-0.54) {$\strut\mathtt{#3}$};
	\node at (2,-0.54) {$\strut\mathtt{\overline{#3}}$};
}

%=========================================MPM
%\def\larg{0.25}
\newcommand\MPMbase[3]{%
	\FPeval{\Larg}{2.5*\larg}
	\node[inner sep=0] (#3) at (#1,#2) {%
		\begin{tabular}{|C{\Larg cm}|}
			\hline
			{\scriptsize\sffamily\textbf{#3}} \\ \hline
	\end{tabular}};
}

\newcommand\MPMdebut[5]{%
	\node[inner sep=0] (#3) at (#1,#2) {%
		\begin{tabular}{|C{\larg cm}|C{\larg cm}|}
			\hline
			\multicolumn{2}{|c|}{{\scriptsize\sffamily\textbf{Début}}} \\ \hline
			{\scriptsize\sffamily #4}&{\scriptsize\sffamily #5} \\ \hline
	\end{tabular}};
}

\newcommand\MPMsommet[6]{%
	\node[inner sep=0] (#3) at (#1,#2) {%
		\begin{tabular}{|C{\larg cm}|C{\larg cm}|}
			\hline
			\multicolumn{2}{|c|}{{\scriptsize\sffamily\textbf{#4}}} \\ \hline
			{\scriptsize\sffamily #5}&{\scriptsize\sffamily #6}\\ \hline
	\end{tabular}};
}

\newcommand\MPMfin[5]{%
	\node[inner sep=0] (#3) at (#1,#2) {%
		\begin{tabular}{|C{\larg cm}|C{\larg cm}|}
			\hline
			\multicolumn{2}{|c|}{{\scriptsize\sffamily\textbf{Fin}}} \\ \hline
			{\scriptsize\sffamily #4}&{\scriptsize\sffamily #5}\\ \hline
	\end{tabular}};
}

\newcommand\MPMnotice[2]{%
	\node[inner sep=0] (Ntce) at (#1,#2) {%
		\begin{tabular}{|C{\larg cm}|C{\larg cm}|}
			\multicolumn{2}{c}{{\small\sffamily\textcolor{violet}{\textbf{Aide}}}} \\ \hline
			\multicolumn{2}{|c|}{{\scriptsize\sffamily\textbf{Som.}}} \\ \hline
			{\scriptsize\sffamily t}&{\scriptsize\sffamily T}\\ \hline
	\end{tabular}};
}

\newcommand\MPMnoticeC[2]{%
	\node[inner sep=0] (Ntce) at (#1,#2) {%
		\begin{tabular}{|C{\larg cm}|C{\larg cm}|}
			\multicolumn{2}{c}{{\small\sffamily\textcolor{violet}{\textbf{Aide}}}} \\ \hline
			\multicolumn{2}{|c|}{{\scriptsize\sffamily\textbf{Sommet}}} \\ \hline
			{\scriptsize\sffamily t}&{\scriptsize\sffamily T}\\ \hline
			{\scriptsize\sffamily MT}&{\scriptsize\sffamily ML} \\ \hline
	\end{tabular}};
}

\newcommand\MPMsommetC[8]{%
	\node[inner sep=0] (#3) at (#1,#2) {%
		\begin{tabular}{|C{\larg cm}|C{\larg cm}|}
			\hline
			\multicolumn{2}{|c|}{{\scriptsize\sffamily \textbf{#4}}} \\ \hline
			{\scriptsize\sffamily #5}&{\scriptsize\sffamily #6}\\ \hline
			{\scriptsize\sffamily #7}&{\scriptsize\sffamily #8} \\ \hline
	\end{tabular}};
}

\newcommand\MPMarcts[4][midway,inner sep=1pt]{%
	\draw[line width=1pt,blue,->,>= stealth'] (#2) -- (#3) node[#1,fill=white,text=red]{\footnotesize\sffamily #4};
}

\newcommand\MPMarcangle[5][near start,inner sep=1pt]{%
	\draw[->,>=stealth',line width=1pt,blue] (#3) #2 (#4) node[#1,fill=white,text=red] {\footnotesize\sffamily #5};
}

\newcommand\MPMarcangles[6][midway,inner sep=1pt]{%
	\draw[->,>=stealth',line width=1pt,blue] (#2) -- (#3) -- (#4) node[#1,fill=white,text=red] {\footnotesize\sffamily #6} -- (#5);
}

\newcommand\point[1]{\Large\textsf{#1}}
\newcommand\ppoint[1]{\large\textsf{#1}}
\newcommand\graphpt[1]{(\textcolor{#1}{$\CIRCLE$})}
\newcommand\graphlg[1]{(\textcolor{#1}{\boldmath$-\:-$\unboldmath})}

\newcommand\noticetikz{\@ifstar{\noticetkz@star}{\noticetkz@nostar}}

\newcommand\noticetkz@star[1]{%
	$\vcenter{\hbox{\begin{tikzpicture}\draw[color=#1,very thick,densely dashed](0,0)--(0.57,0);\filldraw[fill=#1,draw=#1,thick] (0.57,0) circle (3pt);\end{tikzpicture}}}$
}
\newcommand\noticetkz@nostar[1]{%
	$\vcenter{\hbox{\begin{tikzpicture}\draw[color=#1,very thick,densely dashed](0,0)--(0.57,0);\filldraw[fill=white,draw=#1,thick] (0.57,0) circle (3pt);\end{tikzpicture}}}$
}

\newcommand\noticetikzf[1]{%
	$\vcenter{\hbox{\begin{tikzpicture}\draw[#1,thick,<->](0,0)--(0.65,0);\end{tikzpicture}}}$
}

\newcommand\noticetikzt[1]{%
	$\vcenter{\hbox{\begin{tikzpicture}\draw[#1,thick](0,0)--(0.65,0);\end{tikzpicture}}}$
}

%==========================styles pas-tableur
\definecolor{graySepCell}{cmyk}{0,0,0,0.75}
\newcommand\celcolor[2]{\draw[draw=none,fill=lightgray] ($(cell#1-#2.south west)+(0.2pt,0.2pt)$) -- ($(cell#1-#2.south east) + (-0.2pt,0.2pt)$) -- ($(cell#1-#2.north east) + (-0.2pt,-0.2pt)$) -- ($(cell#1-#2.north west) + (0.2pt,-0.2pt)$) -- cycle;}
\newcommand\celtxtmulti[4]{\draw (cell#1-#2.center) node [align=center,text width=#3]{#4};}
\newcommand\celtxtlmulti[4]{\draw (cell#1-#2.center) node [align=left,text width=#3]{#4};}
\newcommand\celfusion[4]{\draw[draw=none,fill=white] ($(cell#1-#2.south west)+(0.2pt,0.2pt)$) rectangle ($(cell#3-#4.north east) + (-0.2pt,-0.2pt)$);}
\newcommand\celnum[3]{%
	\def\numpointilles{#1}
	\FPeval{numavant}{clip(\numpointilles-1)}
	\def\numdebut{#2}
	\def\numfin{#3}
	\foreach \num@line [remember=\num@line as \lastnum (initially \numavant)] in {\numpointilles}
		{%
			\pastab@draw@cell{\numline@width}{numline\num@line}{3}{numline\lastnum.south east}{\dots}%
		}%
	\foreach \num@line [remember=\num@line as \lastnum (initially \numpointilles)] in {\numdebut,\numfin}
		{%
			\pastab@draw@cell{\numline@width}{numline\num@line}{3}{numline\lastnum.south east}{\num@line}%
		}%
}

%==========================piedbtsblanc
\defKV[piedexam]{%
	Session=\def\FooterExamSession{#1},%
	Classe=\def\FooterExamClasse{#1},%
	Epreuve=\def\FooterExamEpreuve{#1},%
	Num=\def\FooterExamNum{#1},%
	Type=\def\FooterExamType{#1}
}

\setKVdefault[piedexam]{%
	Session=\the\year,%
	Classe=SIO2,%
	Epreuve=E2,%
	Num=1,%
	Type=BB0
}

\newcommand\piedbtsblanctblr[1]{%
	\useKVdefault[piedexam]%
	\setKV[piedexam]{#1}%
	\IfSubStr{\FooterExamClasse}{1}%
		{\def\tmpcode{1}}%
		{\def\tmpcode{2}}%
	\IfSubStr{\FooterExamEpreuve}{F}%
		{%
			\def\tmplabel{MATHÉMATIQUES APPROFONDIES}%
			\def\tmpepr{EF}%
			\def\tmpduree{2 heures}%
			\def\tmpcoeff{1}%
		}%
		{%
			\def\tmplabel{MATHÉMATIQUES POUR L'INFORMATIQUE}%
			\def\tmpepr{E}%
			\def\tmpduree{55 minutes}%
			\def\tmpcoeff{2}%
		}%
	\begin{tblr}{rowsep=0pt,width=\linewidth,hlines,vlines,colspec={X[3.67,l,m]X[l,m]X[1,l,m]},cells={font=\sffamily}}
		BTS SERVICES INFORMATIQUES AUX ORGANISATIONS & \SetCell[c=2]{c,m} SESSION : 20\FooterExamSession & \\
		\SetCell[r=2]{m} ÉPREUVE : \tmplabel & \SetCell[c=2]{c,m} SUJET & \\
		& Coefficient : \tmpcoeff & \SetCell[r=2]{c,m} Page \thepage{}/\pageref{LastPage} \\
		\textbf{\FooterExamSession{}SI\tmpepr{}\tmpcode{}MAT\FooterExamType\FooterExamNum} & Durée : \tmpduree & \\
	\end{tblr}%
}

\endinput